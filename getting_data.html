<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Getting Eurostat data on health and mortality</title>
<meta name="author" content="Jan Boone@@latex:\thanks{Tilburg University, Department of Economics, Tilec and CEPR, E-mail: \textit{j.boone@uvt.nl}.}@@" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" href="./latex-css/style.css">
<link rel="stylesheet" href="https://latex.now.sh/prism/prism.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>

<script src="http://orgmode.org/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
// @license-end
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Getting Eurostat data on health and mortality</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga08212b">1. Introduction</a></li>
<li><a href="#org7e0b44c">2. Preamble code</a></li>
<li><a href="#org8c4be75">3. Data</a>
<ul>
<li><a href="#orgc930562">3.1. country data</a>
<ul>
<li><a href="#org38e5993">3.1.1. OOP per country</a></li>
<li><a href="#orgd7e7161">3.1.2. healthcare expenditure</a></li>
</ul>
</li>
<li><a href="#orgc1a2956">3.2. nuts 2</a>
<ul>
<li><a href="#org294543d">3.2.1. crude number of deaths and population by age and sex</a></li>
<li><a href="#org8ca9647">3.2.2. mortality lagged per age</a></li>
<li><a href="#org0e2fc9d">3.2.3. Poverty measures</a></li>
<li><a href="#org9721376">3.2.4. unmet needs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf970804">4. Combining data</a>
<ul>
<li><a href="#orga434508">4.1. nuts2 data</a></li>
<li><a href="#orge1b4690">4.2. country data</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orga08212b" class="outline-2">
<h2 id="orga08212b"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This file describes how we get the data for our project on <a href="./index.html">the health effects of demand side cost sharing</a>.
</p>

<p>
In this file we explain how we get the data and from where and at the same time we generate the data. By generating the data in this way, a change in the data by Eurostat will lead to (slightly) different results.
</p>

<ul class="org-ul">
<li>Overview of data available at the region level: <a href="https://ec.europa.eu/eurostat/web/regions/background">https://ec.europa.eu/eurostat/web/regions/background</a></li>
<li>Link to excel file with overview: <a href="http://ec.europa.eu/eurostat/documents/140934/4381644/Regional-statistics-overview.xlsx">http://ec.europa.eu/eurostat/documents/140934/4381644/Regional-statistics-overview.xlsx</a></li>
</ul>


<p>
The dataset itself is too big for github and can be found on <a href="https://dataverse.nl/dataset.xhtml?persistentId=doi:10.34894/AABEBD">DataverseNL</a>.
</p>
</div>
</div>


<div id="outline-container-org7e0b44c" class="outline-2">
<h2 id="org7e0b44c"><span class="section-number-2">2.</span> Preamble code</h2>
<div class="outline-text-2" id="text-2">
<p>
Run this code first before running the code of particular data sets. It imports the relevant libraries.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> numpy <span style="color: #89DDFF;">as</span> np
<span style="color: #89DDFF;">import</span> pandas <span style="color: #89DDFF;">as</span> pd
<span style="color: #89DDFF;">from</span> country_codes <span style="color: #89DDFF;">import</span> oecd_dictionary, eurostat_dictionary
<span style="color: #89DDFF;">import</span> eurostat
<span style="color: #89DDFF;">import</span> xarray <span style="color: #89DDFF;">as</span> xr
<span style="color: #89DDFF;">import</span> matplotlib.pyplot <span style="color: #89DDFF;">as</span> plt

<span style="color: #ffcb6b;">EU_countries</span> = [<span style="color: #c3e88d;">'Belgium'</span>, <span style="color: #c3e88d;">'Bulgaria'</span>, <span style="color: #c3e88d;">'Czechia'</span>, <span style="color: #c3e88d;">'Denmark'</span>,
<span style="color: #c3e88d;">'Germany (until 1990 former territory of the FRG)'</span>, <span style="color: #c3e88d;">'Germany'</span>,<span style="color: #c3e88d;">'Estonia'</span>,
<span style="color: #c3e88d;">'Ireland'</span>, <span style="color: #c3e88d;">'Greece'</span>, <span style="color: #c3e88d;">'Spain'</span>, <span style="color: #c3e88d;">'France'</span>, <span style="color: #c3e88d;">'Croatia'</span>, <span style="color: #c3e88d;">'Italy'</span>,
<span style="color: #c3e88d;">'Cyprus'</span>, <span style="color: #c3e88d;">'Latvia'</span>, <span style="color: #c3e88d;">'Lithuania'</span>, <span style="color: #c3e88d;">'Luxembourg'</span>, <span style="color: #c3e88d;">'Hungary'</span>, <span style="color: #c3e88d;">'Malta'</span>,
<span style="color: #c3e88d;">'Netherlands'</span>, <span style="color: #c3e88d;">'Austria'</span>, <span style="color: #c3e88d;">'Poland'</span>, <span style="color: #c3e88d;">'Portugal'</span>, <span style="color: #c3e88d;">'Romania'</span>,
<span style="color: #c3e88d;">'Slovenia'</span>, <span style="color: #c3e88d;">'Slovakia'</span>, <span style="color: #c3e88d;">'Finland'</span>, <span style="color: #c3e88d;">'Sweden'</span>, <span style="color: #c3e88d;">'United Kingdom'</span>,
<span style="color: #c3e88d;">'Iceland'</span>, <span style="color: #c3e88d;">'Liechtenstein'</span>, <span style="color: #c3e88d;">'Norway'</span>, <span style="color: #c3e88d;">'Switzerland'</span>,
<span style="color: #c3e88d;">'Bosnia and Herzegovina'</span>]

</pre>
</div>


<p>
We first describe how we get the data for each variable. Each of these variables is saved in a separate dataset. The final section contains the code that merges the data for these variables into one (big) dataset.
</p>
</div>
</div>

<div id="outline-container-org8c4be75" class="outline-2">
<h2 id="org8c4be75"><span class="section-number-2">3.</span> Data</h2>
<div class="outline-text-2" id="text-3">
<p>
First, we fetch the variables at the country level from the Eurostat website. Then we move to the NUTS 2 regional data.
</p>
</div>

<div id="outline-container-orgc930562" class="outline-3">
<h3 id="orgc930562"><span class="section-number-3">3.1.</span> country data</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org38e5993" class="outline-4">
<h4 id="org38e5993"><span class="section-number-4">3.1.1.</span> OOP per country</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
We want a measure of "how generous" a healthcare system is in terms of oop-payments. This feature of the healthcare system tends to be defined at the country level. We use household oop payment and expenditure on voluntary payment schemes (for things that are not covered by basic or mandatory insurance). The paper uses mainly <code>PC_CHE</code> as unit of measurement.
</p>

<ul class="org-ul">
<li>link to data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_sha11_hf/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_sha11_hf/default/table?lang=en</a></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">abbreviation</th>
<th scope="col" class="org-left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">HF2</td>
<td class="org-left">Voluntary health care payment schemes</td>
</tr>

<tr>
<td class="org-left">HF3</td>
<td class="org-left">Household out-of-pocket payment</td>
</tr>

<tr>
<td class="org-left">PC_CHE</td>
<td class="org-left">Percentual share of total current health expenditure (CHE)</td>
</tr>

<tr>
<td class="org-left">PPS_HAB</td>
<td class="org-left">Purchasing power standard (PPS) per inhabitant</td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'hlth_sha11_hf'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'geo'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df[<span style="color: #c3e88d;">'country_code'</span>] = [x[:2] <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'geo'</span>]]
df[<span style="color: #c3e88d;">'country'</span>] = df[<span style="color: #c3e88d;">'country_code'</span>].replace(eurostat_dictionary)
df = df[df.country.isin(EU_countries)  &amp; \
        (df.icha11_hf.isin([<span style="color: #c3e88d;">"HF2"</span>, <span style="color: #c3e88d;">"HF3"</span>])) &amp;\
        (df.unit.isin([ <span style="color: #c3e88d;">'PC_CHE'</span>,<span style="color: #c3e88d;">'PPS_HAB'</span>]))]
df.drop([<span style="color: #c3e88d;">"geo"</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)

df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,\
                         <span style="color: #c3e88d;">'unit'</span>,<span style="color: #c3e88d;">'icha11_hf'</span>],
                        value_vars=np.arange(1992,2019),
                        var_name=<span style="color: #c3e88d;">'year'</span>,\
             value_name=<span style="color: #c3e88d;">'health_expenditure'</span>)
df.set_index([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,\
              <span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'unit'</span>,<span style="color: #c3e88d;">'icha11_hf'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df = df.unstack()
df.columns = df.columns.droplevel()
df = df.unstack()
df.columns = df.columns.droplevel()
df.columns = [<span style="color: #c3e88d;">'HF2_PC_CHE'</span>,<span style="color: #c3e88d;">'HF2_PPS_HAB'</span>,\
              <span style="color: #c3e88d;">'HF3_PC_CHE'</span>,<span style="color: #c3e88d;">'HF3_PPS_HAB'</span>]
df.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
df.set_index([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,<span style="color: #c3e88d;">'year'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df.tail()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>HF2_PC_CHE</th>
      <th>HF2_PPS_HAB</th>
      <th>HF3_PC_CHE</th>
      <th>HF3_PPS_HAB</th>
    </tr>
    <tr>
      <th>country</th>
      <th>country_code</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">United Kingdom</th>
      <th rowspan="5" valign="top">UK</th>
      <th>2014</th>
      <td>5.40</td>
      <td>155.48</td>
      <td>15.16</td>
      <td>436.73</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>5.40</td>
      <td>161.07</td>
      <td>15.23</td>
      <td>454.78</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>5.04</td>
      <td>148.46</td>
      <td>15.37</td>
      <td>453.16</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>5.41</td>
      <td>160.78</td>
      <td>15.72</td>
      <td>467.53</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>5.62</td>
      <td>172.06</td>
      <td>15.88</td>
      <td>486.25</td>
    </tr>
  </tbody>
</table>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds</span> = df.to_xarray()
ds.to_netcdf(<span style="color: #c3e88d;">"./data/country/out_of_pocket.nc"</span>)
ds
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (country: 33, country_code: 33, year: 27)
Coordinates:
  * country       (country) object &#x27;Austria&#x27; &#x27;Belgium&#x27; ... &#x27;United Kingdom&#x27;
  * country_code  (country_code) object &#x27;AT&#x27; &#x27;BA&#x27; &#x27;BE&#x27; &#x27;BG&#x27; ... &#x27;SI&#x27; &#x27;SK&#x27; &#x27;UK&#x27;
  * year          (year) int64 1992 1993 1994 1995 1996 ... 2015 2016 2017 2018
Data variables:
    HF2_PC_CHE    (country, country_code, year) float64 nan nan ... 5.41 5.62
    HF2_PPS_HAB   (country, country_code, year) float64 nan nan ... 160.8 172.1
    HF3_PC_CHE    (country, country_code, year) float64 nan nan ... 15.72 15.88
    HF3_PPS_HAB   (country, country_code, year) float64 nan nan ... 467.5 486.2</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a1773be3-e7d7-402f-9b7b-f128636d0744' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a1773be3-e7d7-402f-9b7b-f128636d0744' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>country</span>: 33</li><li><span class='xr-has-index'>country_code</span>: 33</li><li><span class='xr-has-index'>year</span>: 27</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8937829c-0909-469f-a31c-6a0201fd156b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8937829c-0909-469f-a31c-6a0201fd156b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country</span></div><div class='xr-var-dims'>(country)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;Austria&#x27; ... &#x27;United Kingdom&#x27;</div><input id='attrs-64ab4fbd-258d-4540-8963-2f3455ee8b14' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64ab4fbd-258d-4540-8963-2f3455ee8b14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd4ada82-a5a4-451e-8121-ecfb1dd4a5c2' class='xr-var-data-in' type='checkbox'><label for='data-cd4ada82-a5a4-451e-8121-ecfb1dd4a5c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Austria&#x27;, &#x27;Belgium&#x27;, &#x27;Bosnia and Herzegovina&#x27;, &#x27;Bulgaria&#x27;, &#x27;Croatia&#x27;,
       &#x27;Cyprus&#x27;, &#x27;Czechia&#x27;, &#x27;Denmark&#x27;, &#x27;Estonia&#x27;, &#x27;Finland&#x27;, &#x27;France&#x27;,
       &#x27;Germany&#x27;, &#x27;Greece&#x27;, &#x27;Hungary&#x27;, &#x27;Iceland&#x27;, &#x27;Ireland&#x27;, &#x27;Italy&#x27;, &#x27;Latvia&#x27;,
       &#x27;Liechtenstein&#x27;, &#x27;Lithuania&#x27;, &#x27;Luxembourg&#x27;, &#x27;Malta&#x27;, &#x27;Netherlands&#x27;,
       &#x27;Norway&#x27;, &#x27;Poland&#x27;, &#x27;Portugal&#x27;, &#x27;Romania&#x27;, &#x27;Slovakia&#x27;, &#x27;Slovenia&#x27;,
       &#x27;Spain&#x27;, &#x27;Sweden&#x27;, &#x27;Switzerland&#x27;, &#x27;United Kingdom&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country_code</span></div><div class='xr-var-dims'>(country_code)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT&#x27; &#x27;BA&#x27; &#x27;BE&#x27; ... &#x27;SI&#x27; &#x27;SK&#x27; &#x27;UK&#x27;</div><input id='attrs-ade9e423-15ea-47e8-89eb-be74710a1505' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ade9e423-15ea-47e8-89eb-be74710a1505' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-007d0bb4-6d8b-43b7-ac8b-fc901d98f32e' class='xr-var-data-in' type='checkbox'><label for='data-007d0bb4-6d8b-43b7-ac8b-fc901d98f32e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT&#x27;, &#x27;BA&#x27;, &#x27;BE&#x27;, &#x27;BG&#x27;, &#x27;CH&#x27;, &#x27;CY&#x27;, &#x27;CZ&#x27;, &#x27;DE&#x27;, &#x27;DK&#x27;, &#x27;EE&#x27;, &#x27;EL&#x27;, &#x27;ES&#x27;,
       &#x27;FI&#x27;, &#x27;FR&#x27;, &#x27;HR&#x27;, &#x27;HU&#x27;, &#x27;IE&#x27;, &#x27;IS&#x27;, &#x27;IT&#x27;, &#x27;LI&#x27;, &#x27;LT&#x27;, &#x27;LU&#x27;, &#x27;LV&#x27;, &#x27;MT&#x27;,
       &#x27;NL&#x27;, &#x27;NO&#x27;, &#x27;PL&#x27;, &#x27;PT&#x27;, &#x27;RO&#x27;, &#x27;SE&#x27;, &#x27;SI&#x27;, &#x27;SK&#x27;, &#x27;UK&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1992 1993 1994 ... 2016 2017 2018</div><input id='attrs-3fbf1bf1-fea8-4879-bbb9-0f92e8df833e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3fbf1bf1-fea8-4879-bbb9-0f92e8df833e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-027e7e08-fdd3-4428-946c-ccb3537a55dc' class='xr-var-data-in' type='checkbox'><label for='data-027e7e08-fdd3-4428-946c-ccb3537a55dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2ba6cf8a-f946-40ae-bf49-b2621bca959f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2ba6cf8a-f946-40ae-bf49-b2621bca959f' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>HF2_PC_CHE</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 5.04 5.41 5.62</div><input id='attrs-5a769f96-4593-4156-ae1e-0422d702aa53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a769f96-4593-4156-ae1e-0422d702aa53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-702cb3d3-5429-400a-8fb8-1d2665b447b0' class='xr-var-data-in' type='checkbox'><label for='data-702cb3d3-5429-400a-8fb8-1d2665b447b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ nan,  nan,  nan, ..., 6.8 , 6.83, 6.91],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 4.74, 4.86, 4.9 ],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 0.3 , 0.37, 0.4 ],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
...
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 5.04, 5.41, 5.62]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF2_PPS_HAB</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 148.5 160.8 172.1</div><input id='attrs-2fc19ad2-20b1-4d8f-bd42-6784b1350345' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2fc19ad2-20b1-4d8f-bd42-6784b1350345' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0cf0036-0f57-46e1-9137-3991c486a2cb' class='xr-var-data-in' type='checkbox'><label for='data-e0cf0036-0f57-46e1-9137-3991c486a2cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   nan,    nan,    nan, ..., 260.74, 263.61, 274.53],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 175.08, 180.84, 187.76],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,   2.54,   3.08,   3.48],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
...
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 148.46, 160.78, 172.06]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF3_PC_CHE</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 15.37 15.72 15.88</div><input id='attrs-44d6aa07-bcac-4712-85c4-8eca7e3505ef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44d6aa07-bcac-4712-85c4-8eca7e3505ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a519034-c7c5-494f-a411-156ac04a5074' class='xr-var-data-in' type='checkbox'><label for='data-9a519034-c7c5-494f-a411-156ac04a5074' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[  nan,   nan,   nan, ..., 19.24, 19.15, 18.43],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 18.09, 17.91, 17.81],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 28.61, 29.12, 29.31],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
...
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 15.37, 15.72, 15.88]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF3_PPS_HAB</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 453.2 467.5 486.2</div><input id='attrs-f8f4d140-1f23-4d63-88cd-6785233e17c2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8f4d140-1f23-4d63-88cd-6785233e17c2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a788bc64-3750-48c1-8c42-0db5b25cbae8' class='xr-var-data-in' type='checkbox'><label for='data-a788bc64-3750-48c1-8c42-0db5b25cbae8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   nan,    nan,    nan, ..., 738.36, 739.37, 732.45],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 667.95, 665.96, 682.09],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 242.78, 242.47, 256.89],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
...
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 453.16, 467.53, 486.25]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d335e1ad-a721-45ce-97d4-f72b5fae4c77' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d335e1ad-a721-45ce-97d4-f72b5fae4c77' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</div>




<div id="outline-container-orgd7e7161" class="outline-4">
<h4 id="orgd7e7161"><span class="section-number-4">3.1.2.</span> healthcare expenditure</h4>
<div class="outline-text-4" id="text-3-1-2">
<ul class="org-ul">
<li>link to data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_sha11_hc/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_sha11_hc/default/table?lang=en</a></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">abbreviation</th>
<th scope="col" class="org-left">variable name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">TOT_HC</td>
<td class="org-left">Current health care expenditure (CHE)</td>
</tr>

<tr>
<td class="org-left">EUR_HAB</td>
<td class="org-left">Euro per inhabitant</td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'hlth_sha11_hc'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'geo'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df[<span style="color: #c3e88d;">'country_code'</span>] = [x[:2] <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'geo'</span>]]
df[<span style="color: #c3e88d;">'country'</span>] = df[<span style="color: #c3e88d;">'country_code'</span>].replace(eurostat_dictionary)
df = df[df.country.isin(EU_countries)  &amp; \
        (df.icha11_hc.isin([<span style="color: #c3e88d;">"TOT_HC"</span>])) &amp; \
        (df.unit.isin([<span style="color: #c3e88d;">'EUR_HAB'</span>]))]
df.drop([<span style="color: #c3e88d;">"geo"</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)

df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,\
                         <span style="color: #c3e88d;">'unit'</span>,<span style="color: #c3e88d;">'icha11_hc'</span>],
                        value_vars=np.arange(1992,2020),
                        var_name=<span style="color: #c3e88d;">'year'</span>,\
             value_name=<span style="color: #c3e88d;">'health_expenditure'</span>)
df.set_index([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,<span style="color: #c3e88d;">'year'</span>,\
              <span style="color: #c3e88d;">'unit'</span>,<span style="color: #c3e88d;">'icha11_hc'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df = df.unstack()
df.columns = df.columns.droplevel()
df = df.unstack()
df.columns = df.columns.droplevel()
df.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
df.rename({<span style="color: #c3e88d;">'EUR_HAB'</span>:<span style="color: #c3e88d;">'health expenditure per capita'</span>},\
          axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df.set_index([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>,<span style="color: #c3e88d;">'year'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>unit</th>
      <th>health expenditure per capita</th>
    </tr>
    <tr>
      <th>country</th>
      <th>country_code</th>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Austria</th>
      <th rowspan="5" valign="top">AT</th>
      <th>1992</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds</span> = df.to_xarray()
ds.to_netcdf(<span style="color: #c3e88d;">"./data/country/healthcare_expenditure.nc"</span>)
ds
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                        (country: 33, country_code: 33, year: 28)
Coordinates:
  * country                        (country) object &#x27;Austria&#x27; ... &#x27;United Kin...
  * country_code                   (country_code) object &#x27;AT&#x27; &#x27;BA&#x27; ... &#x27;SK&#x27; &#x27;UK&#x27;
  * year                           (year) int64 1992 1993 1994 ... 2018 2019
Data variables:
    health expenditure per capita  (country, country_code, year) float64 nan ...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f762ce49-e360-47d5-9198-005c31ea827a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f762ce49-e360-47d5-9198-005c31ea827a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>country</span>: 33</li><li><span class='xr-has-index'>country_code</span>: 33</li><li><span class='xr-has-index'>year</span>: 28</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6b154b26-6e24-429c-9107-cfbef95875db' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6b154b26-6e24-429c-9107-cfbef95875db' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country</span></div><div class='xr-var-dims'>(country)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;Austria&#x27; ... &#x27;United Kingdom&#x27;</div><input id='attrs-d5baec19-0e7c-4a37-933c-669fe8644950' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d5baec19-0e7c-4a37-933c-669fe8644950' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8db18c77-4fe9-4f7d-b99e-9454383b835c' class='xr-var-data-in' type='checkbox'><label for='data-8db18c77-4fe9-4f7d-b99e-9454383b835c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Austria&#x27;, &#x27;Belgium&#x27;, &#x27;Bosnia and Herzegovina&#x27;, &#x27;Bulgaria&#x27;, &#x27;Croatia&#x27;,
       &#x27;Cyprus&#x27;, &#x27;Czechia&#x27;, &#x27;Denmark&#x27;, &#x27;Estonia&#x27;, &#x27;Finland&#x27;, &#x27;France&#x27;,
       &#x27;Germany&#x27;, &#x27;Greece&#x27;, &#x27;Hungary&#x27;, &#x27;Iceland&#x27;, &#x27;Ireland&#x27;, &#x27;Italy&#x27;, &#x27;Latvia&#x27;,
       &#x27;Liechtenstein&#x27;, &#x27;Lithuania&#x27;, &#x27;Luxembourg&#x27;, &#x27;Malta&#x27;, &#x27;Netherlands&#x27;,
       &#x27;Norway&#x27;, &#x27;Poland&#x27;, &#x27;Portugal&#x27;, &#x27;Romania&#x27;, &#x27;Slovakia&#x27;, &#x27;Slovenia&#x27;,
       &#x27;Spain&#x27;, &#x27;Sweden&#x27;, &#x27;Switzerland&#x27;, &#x27;United Kingdom&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country_code</span></div><div class='xr-var-dims'>(country_code)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT&#x27; &#x27;BA&#x27; &#x27;BE&#x27; ... &#x27;SI&#x27; &#x27;SK&#x27; &#x27;UK&#x27;</div><input id='attrs-accd4c84-6b46-4065-874d-fd94cdcf6ff8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-accd4c84-6b46-4065-874d-fd94cdcf6ff8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-483e27d1-3789-4d0b-bcba-32d87857dc11' class='xr-var-data-in' type='checkbox'><label for='data-483e27d1-3789-4d0b-bcba-32d87857dc11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT&#x27;, &#x27;BA&#x27;, &#x27;BE&#x27;, &#x27;BG&#x27;, &#x27;CH&#x27;, &#x27;CY&#x27;, &#x27;CZ&#x27;, &#x27;DE&#x27;, &#x27;DK&#x27;, &#x27;EE&#x27;, &#x27;EL&#x27;, &#x27;ES&#x27;,
       &#x27;FI&#x27;, &#x27;FR&#x27;, &#x27;HR&#x27;, &#x27;HU&#x27;, &#x27;IE&#x27;, &#x27;IS&#x27;, &#x27;IT&#x27;, &#x27;LI&#x27;, &#x27;LT&#x27;, &#x27;LU&#x27;, &#x27;LV&#x27;, &#x27;MT&#x27;,
       &#x27;NL&#x27;, &#x27;NO&#x27;, &#x27;PL&#x27;, &#x27;PT&#x27;, &#x27;RO&#x27;, &#x27;SE&#x27;, &#x27;SI&#x27;, &#x27;SK&#x27;, &#x27;UK&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1992 1993 1994 ... 2017 2018 2019</div><input id='attrs-2ce24650-c2c4-413d-afca-7ba3256b32dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2ce24650-c2c4-413d-afca-7ba3256b32dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2fd467e7-8076-47ed-a7a6-99836cce6f60' class='xr-var-data-in' type='checkbox'><label for='data-2fd467e7-8076-47ed-a7a6-99836cce6f60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e89ce06a-3603-40f9-b49e-d3f5ff7b0bf8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e89ce06a-3603-40f9-b49e-d3f5ff7b0bf8' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>health expenditure per capita</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 3.608e+03 3.839e+03</div><input id='attrs-46001961-5386-41e5-9264-8341edccec9e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-46001961-5386-41e5-9264-8341edccec9e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38c5420d-17d3-4c7e-bc3d-af9408ddc3c7' class='xr-var-data-in' type='checkbox'><label for='data-38c5420d-17d3-4c7e-bc3d-af9408ddc3c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[    nan,     nan,     nan, ..., 4359.69, 4510.08, 4689.27],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        ...,
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan]],

       [[    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ..., 4206.56, 4343.57, 4438.82],
        ...,
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan]],

       [[    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,  409.09,  434.88,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        ...,
...
        ...,
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan]],

       [[    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        ...,
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan]],

       [[    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        ...,
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ...,     nan,     nan,     nan],
        [    nan,     nan,     nan, ..., 3503.62, 3607.59, 3838.53]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5dccd30c-e23e-4d31-9518-fd7d6bb09312' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5dccd30c-e23e-4d31-9518-fd7d6bb09312' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</div>
</div>



<div id="outline-container-orgc1a2956" class="outline-3">
<h3 id="orgc1a2956"><span class="section-number-3">3.2.</span> nuts 2</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>overview of regional data: <a href="https://ec.europa.eu/eurostat/web/regions/data/database">https://ec.europa.eu/eurostat/web/regions/data/database</a></li>
</ul>
</div>

<div id="outline-container-org294543d" class="outline-4">
<h4 id="org294543d"><span class="section-number-4">3.2.1.</span> crude number of deaths and population by age and sex</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>population: <a href="https://ec.europa.eu/eurostat/databrowser/view/demo_r_d2jan/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/demo_r_d2jan/default/table?lang=en</a></li>
</ul>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'demo_r_d2jan'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'geo'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
age_range = [<span style="color: #c3e88d;">'Y1'</span>, <span style="color: #c3e88d;">'Y10'</span>, <span style="color: #c3e88d;">'Y11'</span>, <span style="color: #c3e88d;">'Y12'</span>, <span style="color: #c3e88d;">'Y13'</span>, <span style="color: #c3e88d;">'Y14'</span>, <span style="color: #c3e88d;">'Y15'</span>,
       <span style="color: #c3e88d;">'Y16'</span>, <span style="color: #c3e88d;">'Y17'</span>, <span style="color: #c3e88d;">'Y18'</span>, <span style="color: #c3e88d;">'Y19'</span>, <span style="color: #c3e88d;">'Y2'</span>, <span style="color: #c3e88d;">'Y20'</span>, <span style="color: #c3e88d;">'Y21'</span>, <span style="color: #c3e88d;">'Y22'</span>, <span style="color: #c3e88d;">'Y23'</span>,
       <span style="color: #c3e88d;">'Y24'</span>, <span style="color: #c3e88d;">'Y25'</span>, <span style="color: #c3e88d;">'Y26'</span>, <span style="color: #c3e88d;">'Y27'</span>, <span style="color: #c3e88d;">'Y28'</span>, <span style="color: #c3e88d;">'Y29'</span>, <span style="color: #c3e88d;">'Y3'</span>, <span style="color: #c3e88d;">'Y30'</span>, <span style="color: #c3e88d;">'Y31'</span>,
       <span style="color: #c3e88d;">'Y32'</span>, <span style="color: #c3e88d;">'Y33'</span>, <span style="color: #c3e88d;">'Y34'</span>, <span style="color: #c3e88d;">'Y35'</span>, <span style="color: #c3e88d;">'Y36'</span>, <span style="color: #c3e88d;">'Y37'</span>, <span style="color: #c3e88d;">'Y38'</span>, <span style="color: #c3e88d;">'Y39'</span>, <span style="color: #c3e88d;">'Y4'</span>,
       <span style="color: #c3e88d;">'Y40'</span>, <span style="color: #c3e88d;">'Y41'</span>, <span style="color: #c3e88d;">'Y42'</span>, <span style="color: #c3e88d;">'Y43'</span>, <span style="color: #c3e88d;">'Y44'</span>, <span style="color: #c3e88d;">'Y45'</span>, <span style="color: #c3e88d;">'Y46'</span>, <span style="color: #c3e88d;">'Y47'</span>, <span style="color: #c3e88d;">'Y48'</span>,
       <span style="color: #c3e88d;">'Y49'</span>, <span style="color: #c3e88d;">'Y5'</span>, <span style="color: #c3e88d;">'Y50'</span>, <span style="color: #c3e88d;">'Y51'</span>, <span style="color: #c3e88d;">'Y52'</span>, <span style="color: #c3e88d;">'Y53'</span>, <span style="color: #c3e88d;">'Y54'</span>, <span style="color: #c3e88d;">'Y55'</span>, <span style="color: #c3e88d;">'Y56'</span>,
       <span style="color: #c3e88d;">'Y57'</span>, <span style="color: #c3e88d;">'Y58'</span>, <span style="color: #c3e88d;">'Y59'</span>, <span style="color: #c3e88d;">'Y6'</span>, <span style="color: #c3e88d;">'Y60'</span>, <span style="color: #c3e88d;">'Y61'</span>, <span style="color: #c3e88d;">'Y62'</span>, <span style="color: #c3e88d;">'Y63'</span>, <span style="color: #c3e88d;">'Y64'</span>,
       <span style="color: #c3e88d;">'Y65'</span>, <span style="color: #c3e88d;">'Y66'</span>, <span style="color: #c3e88d;">'Y67'</span>, <span style="color: #c3e88d;">'Y68'</span>, <span style="color: #c3e88d;">'Y69'</span>, <span style="color: #c3e88d;">'Y7'</span>, <span style="color: #c3e88d;">'Y70'</span>, <span style="color: #c3e88d;">'Y71'</span>, <span style="color: #c3e88d;">'Y72'</span>,
       <span style="color: #c3e88d;">'Y73'</span>, <span style="color: #c3e88d;">'Y74'</span>, <span style="color: #c3e88d;">'Y75'</span>, <span style="color: #c3e88d;">'Y76'</span>, <span style="color: #c3e88d;">'Y77'</span>, <span style="color: #c3e88d;">'Y78'</span>, <span style="color: #c3e88d;">'Y79'</span>, <span style="color: #c3e88d;">'Y8'</span>, <span style="color: #c3e88d;">'Y80'</span>,
       <span style="color: #c3e88d;">'Y81'</span>, <span style="color: #c3e88d;">'Y82'</span>, <span style="color: #c3e88d;">'Y83'</span>, <span style="color: #c3e88d;">'Y84'</span>, <span style="color: #c3e88d;">'Y85'</span>, <span style="color: #c3e88d;">'Y86'</span>, <span style="color: #c3e88d;">'Y87'</span>, <span style="color: #c3e88d;">'Y88'</span>, <span style="color: #c3e88d;">'Y89'</span>,
       <span style="color: #c3e88d;">'Y9'</span>, <span style="color: #c3e88d;">'Y90'</span>, <span style="color: #c3e88d;">'Y91'</span>, <span style="color: #c3e88d;">'Y92'</span>, <span style="color: #c3e88d;">'Y93'</span>, <span style="color: #c3e88d;">'Y94'</span>, <span style="color: #c3e88d;">'Y95'</span>, <span style="color: #c3e88d;">'Y96'</span>, <span style="color: #c3e88d;">'Y97'</span>,
       <span style="color: #c3e88d;">'Y98'</span>, <span style="color: #c3e88d;">'Y99'</span>]
df[<span style="color: #c3e88d;">'country_code'</span>] = [x[:2] <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'geo'</span>]]
df[<span style="color: #c3e88d;">'country'</span>] = df[<span style="color: #c3e88d;">'country_code'</span>].replace(eurostat_dictionary)
df = df[df.country.isin(EU_countries) &amp; \
        (df.sex.isin([<span style="color: #c3e88d;">"M"</span>,<span style="color: #c3e88d;">"F"</span>])) &amp; (df.age.isin(age_range))]
df.drop([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'geo'</span>,<span style="color: #c3e88d;">'sex'</span>,<span style="color: #c3e88d;">'age'</span>],
                        value_vars=np.arange(1990,2021),
                        var_name=<span style="color: #c3e88d;">'year'</span>,value_name=<span style="color: #c3e88d;">'population'</span>)
df[<span style="color: #c3e88d;">'nuts'</span>] = [<span style="color: #82aaff;">len</span>(x)-2 <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df.geo]
df = df.query(<span style="color: #c3e88d;">'nuts == 2'</span>)
df.drop(<span style="color: #c3e88d;">'nuts'</span>,inplace=<span style="color: #f78c6c;">True</span>, axis=1)
df.rename({<span style="color: #c3e88d;">'geo'</span>:<span style="color: #c3e88d;">'nuts2'</span>, <span style="color: #c3e88d;">'age'</span>:<span style="color: #c3e88d;">'age string'</span>},\
          axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'age'</span>] = [<span style="color: #82aaff;">float</span>(x.replace(<span style="color: #c3e88d;">'Y'</span>,<span style="color: #c3e88d;">''</span>)) <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'age string'</span>]]
df.drop(<span style="color: #c3e88d;">'age string'</span>,inplace=<span style="color: #f78c6c;">True</span>, axis=1)

df.set_index([<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'sex'</span>,<span style="color: #c3e88d;">'age'</span>],inplace=<span style="color: #f78c6c;">True</span>)

df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>population</th>
    </tr>
    <tr>
      <th>nuts2</th>
      <th>year</th>
      <th>sex</th>
      <th>age</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AT11</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>1345.0</td>
    </tr>
    <tr>
      <th>AT12</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>8038.0</td>
    </tr>
    <tr>
      <th>AT13</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>7240.0</td>
    </tr>
    <tr>
      <th>AT21</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>3042.0</td>
    </tr>
    <tr>
      <th>AT22</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>6491.0</td>
    </tr>
  </tbody>
</table>
</div>



<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds</span> = df.to_xarray()
ds.to_netcdf(<span style="color: #c3e88d;">"./data/population_nuts_2.nc"</span>)
ds
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (age: 99, nuts2: 305, sex: 2, year: 31)
Coordinates:
  * nuts2       (nuts2) object &#x27;AT11&#x27; &#x27;AT12&#x27; &#x27;AT13&#x27; ... &#x27;UKM8&#x27; &#x27;UKM9&#x27; &#x27;UKN0&#x27;
  * year        (year) int64 1990 1991 1992 1993 1994 ... 2017 2018 2019 2020
  * sex         (sex) object &#x27;F&#x27; &#x27;M&#x27;
  * age         (age) float64 1.0 2.0 3.0 4.0 5.0 ... 95.0 96.0 97.0 98.0 99.0
Data variables:
    population  (nuts2, year, sex, age) float64 1.345e+03 1.349e+03 ... nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-14c67d08-dae0-4cec-aead-eac4065d0adc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-14c67d08-dae0-4cec-aead-eac4065d0adc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>age</span>: 99</li><li><span class='xr-has-index'>nuts2</span>: 305</li><li><span class='xr-has-index'>sex</span>: 2</li><li><span class='xr-has-index'>year</span>: 31</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e097eefb-5f06-424f-968e-c6306bb931d7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e097eefb-5f06-424f-968e-c6306bb931d7' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT11&#x27; &#x27;AT12&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;</div><input id='attrs-44608c88-3280-4e9c-9e2d-de9199ba830a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44608c88-3280-4e9c-9e2d-de9199ba830a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2f2e4fa-093a-4041-ba7c-8d402db161b2' class='xr-var-data-in' type='checkbox'><label for='data-e2f2e4fa-093a-4041-ba7c-8d402db161b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT11&#x27;, &#x27;AT12&#x27;, &#x27;AT13&#x27;, ..., &#x27;UKM8&#x27;, &#x27;UKM9&#x27;, &#x27;UKN0&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1990 1991 1992 ... 2018 2019 2020</div><input id='attrs-b316111d-dbfd-4b39-8eb9-a9af0d052b24' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b316111d-dbfd-4b39-8eb9-a9af0d052b24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9376460-6e31-4cb2-a4bc-5bd54b098c18' class='xr-var-data-in' type='checkbox'><label for='data-a9376460-6e31-4cb2-a4bc-5bd54b098c18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
       2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013,
       2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sex</span></div><div class='xr-var-dims'>(sex)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;F&#x27; &#x27;M&#x27;</div><input id='attrs-f5faa5db-891b-4409-b1ea-4b51e2c14127' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f5faa5db-891b-4409-b1ea-4b51e2c14127' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5eff7a69-dd7d-471e-a10d-bd30d688384a' class='xr-var-data-in' type='checkbox'><label for='data-5eff7a69-dd7d-471e-a10d-bd30d688384a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;F&#x27;, &#x27;M&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>age</span></div><div class='xr-var-dims'>(age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 97.0 98.0 99.0</div><input id='attrs-1e931ac6-fdff-4a78-8832-21dbcb165de2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e931ac6-fdff-4a78-8832-21dbcb165de2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67928797-02dd-446e-bd3c-296ff1edeaeb' class='xr-var-data-in' type='checkbox'><label for='data-67928797-02dd-446e-bd3c-296ff1edeaeb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14.,
       15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28.,
       29., 30., 31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42.,
       43., 44., 45., 46., 47., 48., 49., 50., 51., 52., 53., 54., 55., 56.,
       57., 58., 59., 60., 61., 62., 63., 64., 65., 66., 67., 68., 69., 70.,
       71., 72., 73., 74., 75., 76., 77., 78., 79., 80., 81., 82., 83., 84.,
       85., 86., 87., 88., 89., 90., 91., 92., 93., 94., 95., 96., 97., 98.,
       99.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0dba366e-b120-4192-9249-fe40f14b212c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0dba366e-b120-4192-9249-fe40f14b212c' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>population</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.345e+03 1.349e+03 ... nan nan</div><input id='attrs-ae45fdfe-ab12-4aa1-8b99-f51ec16a2760' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ae45fdfe-ab12-4aa1-8b99-f51ec16a2760' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06dfcb11-5d43-40c2-a008-04aef8c76619' class='xr-var-data-in' type='checkbox'><label for='data-06dfcb11-5d43-40c2-a008-04aef8c76619' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[1.3450e+03, 1.3490e+03, 1.4070e+03, ...,        nan,
                 nan,        nan],
         [1.4380e+03, 1.4500e+03, 1.4920e+03, ...,        nan,
                 nan,        nan]],

        [[1.3710e+03, 1.3760e+03, 1.3810e+03, ...,        nan,
                 nan,        nan],
         [1.4550e+03, 1.4660e+03, 1.4700e+03, ...,        nan,
                 nan,        nan]],

        [[1.4360e+03, 1.4140e+03, 1.4260e+03, ...,        nan,
                 nan,        nan],
         [1.4280e+03, 1.4940e+03, 1.5070e+03, ...,        nan,
                 nan,        nan]],

        ...,

        [[1.1630e+03, 1.1810e+03, 1.1690e+03, ..., 7.4000e+01,
          3.7000e+01, 1.9000e+01],
         [1.2910e+03, 1.2630e+03, 1.3150e+03, ..., 1.7000e+01,
...
                 nan,        nan],
         [1.3305e+04, 1.3199e+04, 1.3380e+04, ...,        nan,
                 nan,        nan]],

        ...,

        [[1.1730e+04, 1.1970e+04, 1.2065e+04, ..., 3.6600e+02,
          2.2800e+02, 1.3400e+02],
         [1.2481e+04, 1.2764e+04, 1.2681e+04, ..., 1.1300e+02,
          4.2000e+01, 3.3000e+01]],

        [[       nan,        nan,        nan, ...,        nan,
                 nan,        nan],
         [       nan,        nan,        nan, ...,        nan,
                 nan,        nan]],

        [[       nan,        nan,        nan, ...,        nan,
                 nan,        nan],
         [       nan,        nan,        nan, ...,        nan,
                 nan,        nan]]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-baa33bb9-930e-4d13-a0af-196108f03f13' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-baa33bb9-930e-4d13-a0af-196108f03f13' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>



<ul class="org-ul">
<li>deaths: <a href="https://ec.europa.eu/eurostat/databrowser/view/demo_r_magec/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/demo_r_magec/default/table?lang=en</a></li>
</ul>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'demo_r_magec'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'geo'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
age_range = [<span style="color: #c3e88d;">'Y1'</span>, <span style="color: #c3e88d;">'Y10'</span>, <span style="color: #c3e88d;">'Y11'</span>, <span style="color: #c3e88d;">'Y12'</span>, <span style="color: #c3e88d;">'Y13'</span>, <span style="color: #c3e88d;">'Y14'</span>, <span style="color: #c3e88d;">'Y15'</span>,
       <span style="color: #c3e88d;">'Y16'</span>, <span style="color: #c3e88d;">'Y17'</span>, <span style="color: #c3e88d;">'Y18'</span>, <span style="color: #c3e88d;">'Y19'</span>, <span style="color: #c3e88d;">'Y2'</span>, <span style="color: #c3e88d;">'Y20'</span>, <span style="color: #c3e88d;">'Y21'</span>, <span style="color: #c3e88d;">'Y22'</span>, <span style="color: #c3e88d;">'Y23'</span>,
       <span style="color: #c3e88d;">'Y24'</span>, <span style="color: #c3e88d;">'Y25'</span>, <span style="color: #c3e88d;">'Y26'</span>, <span style="color: #c3e88d;">'Y27'</span>, <span style="color: #c3e88d;">'Y28'</span>, <span style="color: #c3e88d;">'Y29'</span>, <span style="color: #c3e88d;">'Y3'</span>, <span style="color: #c3e88d;">'Y30'</span>, <span style="color: #c3e88d;">'Y31'</span>,
       <span style="color: #c3e88d;">'Y32'</span>, <span style="color: #c3e88d;">'Y33'</span>, <span style="color: #c3e88d;">'Y34'</span>, <span style="color: #c3e88d;">'Y35'</span>, <span style="color: #c3e88d;">'Y36'</span>, <span style="color: #c3e88d;">'Y37'</span>, <span style="color: #c3e88d;">'Y38'</span>, <span style="color: #c3e88d;">'Y39'</span>, <span style="color: #c3e88d;">'Y4'</span>,
       <span style="color: #c3e88d;">'Y40'</span>, <span style="color: #c3e88d;">'Y41'</span>, <span style="color: #c3e88d;">'Y42'</span>, <span style="color: #c3e88d;">'Y43'</span>, <span style="color: #c3e88d;">'Y44'</span>, <span style="color: #c3e88d;">'Y45'</span>, <span style="color: #c3e88d;">'Y46'</span>, <span style="color: #c3e88d;">'Y47'</span>, <span style="color: #c3e88d;">'Y48'</span>,
       <span style="color: #c3e88d;">'Y49'</span>, <span style="color: #c3e88d;">'Y5'</span>, <span style="color: #c3e88d;">'Y50'</span>, <span style="color: #c3e88d;">'Y51'</span>, <span style="color: #c3e88d;">'Y52'</span>, <span style="color: #c3e88d;">'Y53'</span>, <span style="color: #c3e88d;">'Y54'</span>, <span style="color: #c3e88d;">'Y55'</span>, <span style="color: #c3e88d;">'Y56'</span>,
       <span style="color: #c3e88d;">'Y57'</span>, <span style="color: #c3e88d;">'Y58'</span>, <span style="color: #c3e88d;">'Y59'</span>, <span style="color: #c3e88d;">'Y6'</span>, <span style="color: #c3e88d;">'Y60'</span>, <span style="color: #c3e88d;">'Y61'</span>, <span style="color: #c3e88d;">'Y62'</span>, <span style="color: #c3e88d;">'Y63'</span>, <span style="color: #c3e88d;">'Y64'</span>,
       <span style="color: #c3e88d;">'Y65'</span>, <span style="color: #c3e88d;">'Y66'</span>, <span style="color: #c3e88d;">'Y67'</span>, <span style="color: #c3e88d;">'Y68'</span>, <span style="color: #c3e88d;">'Y69'</span>, <span style="color: #c3e88d;">'Y7'</span>, <span style="color: #c3e88d;">'Y70'</span>, <span style="color: #c3e88d;">'Y71'</span>, <span style="color: #c3e88d;">'Y72'</span>,
       <span style="color: #c3e88d;">'Y73'</span>, <span style="color: #c3e88d;">'Y74'</span>, <span style="color: #c3e88d;">'Y75'</span>, <span style="color: #c3e88d;">'Y76'</span>, <span style="color: #c3e88d;">'Y77'</span>, <span style="color: #c3e88d;">'Y78'</span>, <span style="color: #c3e88d;">'Y79'</span>, <span style="color: #c3e88d;">'Y8'</span>, <span style="color: #c3e88d;">'Y80'</span>,
       <span style="color: #c3e88d;">'Y81'</span>, <span style="color: #c3e88d;">'Y82'</span>, <span style="color: #c3e88d;">'Y83'</span>, <span style="color: #c3e88d;">'Y84'</span>, <span style="color: #c3e88d;">'Y85'</span>, <span style="color: #c3e88d;">'Y86'</span>, <span style="color: #c3e88d;">'Y87'</span>, <span style="color: #c3e88d;">'Y88'</span>, <span style="color: #c3e88d;">'Y89'</span>,
       <span style="color: #c3e88d;">'Y9'</span>, <span style="color: #c3e88d;">'Y90'</span>, <span style="color: #c3e88d;">'Y91'</span>, <span style="color: #c3e88d;">'Y92'</span>, <span style="color: #c3e88d;">'Y93'</span>, <span style="color: #c3e88d;">'Y94'</span>, <span style="color: #c3e88d;">'Y95'</span>, <span style="color: #c3e88d;">'Y96'</span>, <span style="color: #c3e88d;">'Y97'</span>,
       <span style="color: #c3e88d;">'Y98'</span>, <span style="color: #c3e88d;">'Y99'</span>]
df[<span style="color: #c3e88d;">'country_code'</span>] = [x[:2] <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'geo'</span>]]
df[<span style="color: #c3e88d;">'country'</span>] = df[<span style="color: #c3e88d;">'country_code'</span>].replace(eurostat_dictionary)
df = df[df.country.isin(EU_countries) &amp; \
        (df.sex.isin([<span style="color: #c3e88d;">"M"</span>,<span style="color: #c3e88d;">"F"</span>])) &amp; (df.age.isin(age_range))]
df.drop([<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'country_code'</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'geo'</span>,<span style="color: #c3e88d;">'sex'</span>,<span style="color: #c3e88d;">'age'</span>],
                        value_vars=np.arange(1990,2020),
                        var_name=<span style="color: #c3e88d;">'year'</span>,value_name=<span style="color: #c3e88d;">'deaths'</span>)
df[<span style="color: #c3e88d;">'nuts'</span>] = [<span style="color: #82aaff;">len</span>(x)-2 <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df.geo]
df = df.query(<span style="color: #c3e88d;">'nuts == 2'</span>)
df.drop(<span style="color: #c3e88d;">'nuts'</span>,inplace=<span style="color: #f78c6c;">True</span>, axis=1)
df.rename({<span style="color: #c3e88d;">'geo'</span>:<span style="color: #c3e88d;">'nuts2'</span>, <span style="color: #c3e88d;">'age'</span>:<span style="color: #c3e88d;">'age string'</span>},\
          axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'age'</span>] = [<span style="color: #82aaff;">float</span>(x.replace(<span style="color: #c3e88d;">'Y'</span>,<span style="color: #c3e88d;">''</span>)) <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df[<span style="color: #c3e88d;">'age string'</span>]]
df.drop(<span style="color: #c3e88d;">'age string'</span>,inplace=<span style="color: #f78c6c;">True</span>, axis=1)

df.set_index([<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'sex'</span>,<span style="color: #c3e88d;">'age'</span>],inplace=<span style="color: #f78c6c;">True</span>)

df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>nuts2</th>
      <th>year</th>
      <th>sex</th>
      <th>age</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AT11</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th>AT12</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>7.0</td>
    </tr>
    <tr>
      <th>AT13</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>AT21</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>AT22</th>
      <th>1990</th>
      <th>F</th>
      <th>1.0</th>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>



<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds</span> = df.to_xarray()
ds.to_netcdf(<span style="color: #c3e88d;">"./data/deaths_nuts_2.nc"</span>)
ds
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (age: 99, nuts2: 305, sex: 2, year: 30)
Coordinates:
  * nuts2    (nuts2) object &#x27;AT11&#x27; &#x27;AT12&#x27; &#x27;AT13&#x27; &#x27;AT21&#x27; ... &#x27;UKM8&#x27; &#x27;UKM9&#x27; &#x27;UKN0&#x27;
  * year     (year) int64 1990 1991 1992 1993 1994 ... 2015 2016 2017 2018 2019
  * sex      (sex) object &#x27;F&#x27; &#x27;M&#x27;
  * age      (age) float64 1.0 2.0 3.0 4.0 5.0 6.0 ... 95.0 96.0 97.0 98.0 99.0
Data variables:
    deaths   (nuts2, year, sex, age) float64 0.0 0.0 1.0 1.0 ... nan nan nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8d8436b6-d09e-4280-9c14-e1c27052a41f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8d8436b6-d09e-4280-9c14-e1c27052a41f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>age</span>: 99</li><li><span class='xr-has-index'>nuts2</span>: 305</li><li><span class='xr-has-index'>sex</span>: 2</li><li><span class='xr-has-index'>year</span>: 30</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b6489122-be14-4541-83ce-20c67bda5dfa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b6489122-be14-4541-83ce-20c67bda5dfa' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT11&#x27; &#x27;AT12&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;</div><input id='attrs-727da0c0-543b-4b1b-bc0c-5a314c1ab575' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-727da0c0-543b-4b1b-bc0c-5a314c1ab575' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-752b6d66-18a4-4c8b-89b0-83730a005c67' class='xr-var-data-in' type='checkbox'><label for='data-752b6d66-18a4-4c8b-89b0-83730a005c67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT11&#x27;, &#x27;AT12&#x27;, &#x27;AT13&#x27;, ..., &#x27;UKM8&#x27;, &#x27;UKM9&#x27;, &#x27;UKN0&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1990 1991 1992 ... 2017 2018 2019</div><input id='attrs-e26cb964-2b72-4929-8c12-99cc1769f465' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e26cb964-2b72-4929-8c12-99cc1769f465' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81f893d8-705a-4d8d-92a9-91a5e8579b42' class='xr-var-data-in' type='checkbox'><label for='data-81f893d8-705a-4d8d-92a9-91a5e8579b42' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
       2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013,
       2014, 2015, 2016, 2017, 2018, 2019])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sex</span></div><div class='xr-var-dims'>(sex)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;F&#x27; &#x27;M&#x27;</div><input id='attrs-e4aeaf74-9830-4672-ae02-91e823669aa9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4aeaf74-9830-4672-ae02-91e823669aa9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4edf373d-b2d3-441c-b403-f4d6a661bcae' class='xr-var-data-in' type='checkbox'><label for='data-4edf373d-b2d3-441c-b403-f4d6a661bcae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;F&#x27;, &#x27;M&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>age</span></div><div class='xr-var-dims'>(age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 97.0 98.0 99.0</div><input id='attrs-2e84b16f-0194-4fe3-94a5-6d15db292330' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2e84b16f-0194-4fe3-94a5-6d15db292330' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-227d5e63-c8e9-4a2b-b896-cbc563b3a3d6' class='xr-var-data-in' type='checkbox'><label for='data-227d5e63-c8e9-4a2b-b896-cbc563b3a3d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14.,
       15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28.,
       29., 30., 31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42.,
       43., 44., 45., 46., 47., 48., 49., 50., 51., 52., 53., 54., 55., 56.,
       57., 58., 59., 60., 61., 62., 63., 64., 65., 66., 67., 68., 69., 70.,
       71., 72., 73., 74., 75., 76., 77., 78., 79., 80., 81., 82., 83., 84.,
       85., 86., 87., 88., 89., 90., 91., 92., 93., 94., 95., 96., 97., 98.,
       99.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3f3d1045-42f6-468c-b2b0-f1166b41655c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3f3d1045-42f6-468c-b2b0-f1166b41655c' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>deaths</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 1.0 1.0 ... nan nan nan nan</div><input id='attrs-47d1b75c-0a3a-4c5a-85cb-b267432a2f58' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-47d1b75c-0a3a-4c5a-85cb-b267432a2f58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-188dae3d-8f61-4c6a-a80c-1be9acbf227f' class='xr-var-data-in' type='checkbox'><label for='data-188dae3d-8f61-4c6a-a80c-1be9acbf227f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[  0.,   0.,   1., ...,  nan,  nan,  nan],
         [  2.,   0.,   0., ...,  nan,  nan,  nan]],

        [[  0.,   1.,   0., ...,  nan,  nan,  nan],
         [  3.,   0.,   0., ...,  nan,  nan,  nan]],

        [[  1.,   0.,   1., ...,  nan,  nan,  nan],
         [  1.,   0.,   1., ...,  nan,  nan,  nan]],

        ...,

        [[  0.,   0.,   0., ...,  31.,  12.,   4.],
         [  0.,   0.,   0., ...,  11.,   5.,   3.]],

        [[  2.,   0.,   0., ...,  25.,  17.,   5.],
         [  1.,   0.,   0., ...,   3.,   4.,   1.]],

        [[  0.,   0.,   0., ...,  36.,  21.,  16.],
         [  0.,   1.,   0., ...,  12.,   5.,   5.]]],

...

       [[[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        ...,

        [[  1.,   3.,   0., ..., 122.,  84.,  54.],
         [  4.,   2.,   1., ...,  39.,  28.,  17.]],

        [[  2.,   2.,   0., ..., 139.,  69.,  57.],
         [  1.,   1.,   2., ...,  48.,  26.,  18.]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8f6419c8-eaa8-47a2-85a2-fd90ff7eebe9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8f6419c8-eaa8-47a2-85a2-fd90ff7eebe9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</div>


<div id="outline-container-org8ca9647" class="outline-4">
<h4 id="org8ca9647"><span class="section-number-4">3.2.2.</span> mortality lagged per age</h4>
<div class="outline-text-4" id="text-3-2-2">
<ul class="org-ul">
<li>useful link to lag variables in a pandas dataframe: <a href="https://stackoverflow.com/questions/61234837/pandas-panel-data-shifting-values-by-two-taking-into-consideration-year-gaps">https://stackoverflow.com/questions/61234837/pandas-panel-data-shifting-values-by-two-taking-into-consideration-year-gaps</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #ffcb6b;">ds_population</span> = xr.open_dataset(<span style="color: #c3e88d;">'./data/population_nuts_2.nc'</span>)
<span style="color: #ffcb6b;">ds_deaths</span> =  xr.open_dataset(<span style="color: #c3e88d;">'./data/deaths_nuts_2.nc'</span>)

<span style="color: #ffcb6b;">ds_mortality</span> = xr.merge([ds_population, ds_deaths])
ds_mortality
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (age: 99, nuts2: 305, sex: 2, year: 31)
Coordinates:
  * year        (year) int64 1990 1991 1992 1993 1994 ... 2017 2018 2019 2020
  * nuts2       (nuts2) object &#x27;AT11&#x27; &#x27;AT12&#x27; &#x27;AT13&#x27; ... &#x27;UKM8&#x27; &#x27;UKM9&#x27; &#x27;UKN0&#x27;
  * sex         (sex) object &#x27;F&#x27; &#x27;M&#x27;
  * age         (age) float64 1.0 2.0 3.0 4.0 5.0 ... 95.0 96.0 97.0 98.0 99.0
Data variables:
    population  (nuts2, year, sex, age) float64 ...
    deaths      (nuts2, year, sex, age) float64 0.0 0.0 1.0 1.0 ... nan nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-01b03e30-00b3-4c0f-8051-1f41938b2037' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-01b03e30-00b3-4c0f-8051-1f41938b2037' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>age</span>: 99</li><li><span class='xr-has-index'>nuts2</span>: 305</li><li><span class='xr-has-index'>sex</span>: 2</li><li><span class='xr-has-index'>year</span>: 31</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-80e0ca89-4c42-451a-8c46-babfd0e383ea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-80e0ca89-4c42-451a-8c46-babfd0e383ea' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1990 1991 1992 ... 2018 2019 2020</div><input id='attrs-d7939a8e-4b9b-4114-b09f-688c2db447d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d7939a8e-4b9b-4114-b09f-688c2db447d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ddd44f0-79a9-48f4-815a-f98564d5462b' class='xr-var-data-in' type='checkbox'><label for='data-3ddd44f0-79a9-48f4-815a-f98564d5462b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
       2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013,
       2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT11&#x27; &#x27;AT12&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;</div><input id='attrs-9293121d-cf9d-4691-8eb5-ed2fb173fb1d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9293121d-cf9d-4691-8eb5-ed2fb173fb1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ddbbdc27-73fe-40f7-b42d-5d0c7bdfb433' class='xr-var-data-in' type='checkbox'><label for='data-ddbbdc27-73fe-40f7-b42d-5d0c7bdfb433' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT11&#x27;, &#x27;AT12&#x27;, &#x27;AT13&#x27;, ..., &#x27;UKM8&#x27;, &#x27;UKM9&#x27;, &#x27;UKN0&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sex</span></div><div class='xr-var-dims'>(sex)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;F&#x27; &#x27;M&#x27;</div><input id='attrs-1f33e218-783c-42b4-872c-8532f80b98f6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1f33e218-783c-42b4-872c-8532f80b98f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b31bff8-8100-4417-b060-590e03577986' class='xr-var-data-in' type='checkbox'><label for='data-1b31bff8-8100-4417-b060-590e03577986' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;F&#x27;, &#x27;M&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>age</span></div><div class='xr-var-dims'>(age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 97.0 98.0 99.0</div><input id='attrs-f6a64ce1-7fbe-4b9c-a91b-c9dc31b2d1b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f6a64ce1-7fbe-4b9c-a91b-c9dc31b2d1b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1e354d4-4cfc-42dc-8bbe-4e9b0f32338d' class='xr-var-data-in' type='checkbox'><label for='data-a1e354d4-4cfc-42dc-8bbe-4e9b0f32338d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14.,
       15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28.,
       29., 30., 31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42.,
       43., 44., 45., 46., 47., 48., 49., 50., 51., 52., 53., 54., 55., 56.,
       57., 58., 59., 60., 61., 62., 63., 64., 65., 66., 67., 68., 69., 70.,
       71., 72., 73., 74., 75., 76., 77., 78., 79., 80., 81., 82., 83., 84.,
       85., 86., 87., 88., 89., 90., 91., 92., 93., 94., 95., 96., 97., 98.,
       99.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8df57e97-4000-480a-ae54-ab94b80dbfa5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8df57e97-4000-480a-ae54-ab94b80dbfa5' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>population</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2654d66e-bdf8-4a21-b03c-a73d1300af41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2654d66e-bdf8-4a21-b03c-a73d1300af41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bfcd2988-7d9c-4ac4-ae12-9ad7ce6673aa' class='xr-var-data-in' type='checkbox'><label for='data-bfcd2988-7d9c-4ac4-ae12-9ad7ce6673aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1872090 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>deaths</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 1.0 1.0 ... nan nan nan nan</div><input id='attrs-04aaf797-02d6-4de0-a0d3-8604ac121b69' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04aaf797-02d6-4de0-a0d3-8604ac121b69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e87bf3c-0bfd-4086-b034-2a92bfacb011' class='xr-var-data-in' type='checkbox'><label for='data-4e87bf3c-0bfd-4086-b034-2a92bfacb011' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[  0.,   0.,   1., ...,  nan,  nan,  nan],
         [  2.,   0.,   0., ...,  nan,  nan,  nan]],

        [[  0.,   1.,   0., ...,  nan,  nan,  nan],
         [  3.,   0.,   0., ...,  nan,  nan,  nan]],

        [[  1.,   0.,   1., ...,  nan,  nan,  nan],
         [  1.,   0.,   1., ...,  nan,  nan,  nan]],

        ...,

        [[  2.,   0.,   0., ...,  25.,  17.,   5.],
         [  1.,   0.,   0., ...,   3.,   4.,   1.]],

        [[  0.,   0.,   0., ...,  36.,  21.,  16.],
         [  0.,   1.,   0., ...,  12.,   5.,   5.]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]]],

...

       [[[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        ...,

        [[  2.,   2.,   0., ..., 139.,  69.,  57.],
         [  1.,   1.,   2., ...,  48.,  26.,  18.]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

        [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
         [ nan,  nan,  nan, ...,  nan,  nan,  nan]]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c193890b-2e3f-4e77-8b87-6f510f40fd95' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c193890b-2e3f-4e77-8b87-6f510f40fd95' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>




<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df_mortality</span> = ds_mortality.to_dataframe()
<span style="color: #676E95;"># </span><span style="color: #676E95;">drop rows where deaths &gt; population at Jan. 1st</span>
<span style="color: #676E95;"># </span><span style="color: #676E95;">(e.g. because people moved in the year)</span>
<span style="color: #ffcb6b;">df_mortality</span> = df_mortality[(df_mortality.population &gt;= \
                             df_mortality.deaths) &amp;\
                            (df_mortality.population &gt; 0)]
<span style="color: #ffcb6b;">df_mortality</span>[<span style="color: #c3e88d;">'mortality'</span>] = df_mortality[<span style="color: #c3e88d;">'deaths'</span>]/\
    df_mortality[<span style="color: #c3e88d;">'population'</span>]
df_mortality.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
df_mortality.rename({<span style="color: #c3e88d;">'level_3'</span>:<span style="color: #c3e88d;">'year'</span>},\
                    inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df_mortality[<span style="color: #c3e88d;">'year'</span>] = pd.to_datetime(df_mortality[<span style="color: #c3e88d;">'year'</span>],\
                                      <span style="color: #82aaff;">format</span>=<span style="color: #c3e88d;">'%Y'</span>)
df_mortality.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>nuts2</th>
      <th>sex</th>
      <th>year</th>
      <th>population</th>
      <th>deaths</th>
      <th>mortality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1990-01-01</td>
      <td>1345.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1991-01-01</td>
      <td>1371.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1992-01-01</td>
      <td>1436.0</td>
      <td>1.0</td>
      <td>0.000696</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1993-01-01</td>
      <td>1372.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1994-01-01</td>
      <td>1349.0</td>
      <td>1.0</td>
      <td>0.000741</td>
    </tr>
  </tbody>
</table>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">new_column</span> = (df_mortality.set_index([<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'age'</span>,<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'sex'</span>]).\
              groupby([<span style="color: #c3e88d;">'age'</span>,<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'sex'</span>])[<span style="color: #c3e88d;">'mortality'</span>]\
              .shift(1)).to_frame()
new_column.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
new_column.age += 1
new_column[<span style="color: #c3e88d;">'year'</span>] = new_column[<span style="color: #c3e88d;">'year'</span>].dt.year
new_column.rename({<span style="color: #c3e88d;">'mortality'</span>:<span style="color: #c3e88d;">'lagged_mortality'</span>},\
                  inplace=<span style="color: #f78c6c;">True</span>,axis=1)
new_column.set_index([<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'age'</span>,<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'sex'</span>],\
                     inplace=<span style="color: #f78c6c;">True</span>)
new_column.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>lagged_mortality</th>
    </tr>
    <tr>
      <th>year</th>
      <th>age</th>
      <th>nuts2</th>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1990</th>
      <th>2.0</th>
      <th>AT11</th>
      <th>F</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1991</th>
      <th>2.0</th>
      <th>AT11</th>
      <th>F</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1992</th>
      <th>2.0</th>
      <th>AT11</th>
      <th>F</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1993</th>
      <th>2.0</th>
      <th>AT11</th>
      <th>F</th>
      <td>0.000696</td>
    </tr>
    <tr>
      <th>1994</th>
      <th>2.0</th>
      <th>AT11</th>
      <th>F</th>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds</span> = new_column.to_xarray()
ds.to_netcdf(<span style="color: #c3e88d;">"./data/lagged_mortality_nuts_2.nc"</span>)
ds
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (age: 99, nuts2: 297, sex: 2, year: 30)
Coordinates:
  * year              (year) int64 1990 1991 1992 1993 ... 2016 2017 2018 2019
  * age               (age) float64 2.0 3.0 4.0 5.0 6.0 ... 97.0 98.0 99.0 100.0
  * nuts2             (nuts2) object &#x27;AT11&#x27; &#x27;AT12&#x27; &#x27;AT13&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;
  * sex               (sex) object &#x27;F&#x27; &#x27;M&#x27;
Data variables:
    lagged_mortality  (year, age, nuts2, sex) float64 nan nan nan ... nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-800b09d3-7f48-4cc7-b906-e7e378d0478c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-800b09d3-7f48-4cc7-b906-e7e378d0478c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>age</span>: 99</li><li><span class='xr-has-index'>nuts2</span>: 297</li><li><span class='xr-has-index'>sex</span>: 2</li><li><span class='xr-has-index'>year</span>: 30</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f1cba386-6a41-4ed0-8c24-91dc61d9f1c7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f1cba386-6a41-4ed0-8c24-91dc61d9f1c7' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1990 1991 1992 ... 2017 2018 2019</div><input id='attrs-2e9ceb52-0afc-4d55-af31-24894ce71a22' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2e9ceb52-0afc-4d55-af31-24894ce71a22' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72e3f757-4452-4fea-9e05-d3b60b88d41f' class='xr-var-data-in' type='checkbox'><label for='data-72e3f757-4452-4fea-9e05-d3b60b88d41f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
       2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013,
       2014, 2015, 2016, 2017, 2018, 2019])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>age</span></div><div class='xr-var-dims'>(age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0 3.0 4.0 5.0 ... 98.0 99.0 100.0</div><input id='attrs-4c97cb45-5190-485d-a2d0-691965f4731c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4c97cb45-5190-485d-a2d0-691965f4731c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57d7172e-00cc-4912-868e-266428b72722' class='xr-var-data-in' type='checkbox'><label for='data-57d7172e-00cc-4912-868e-266428b72722' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,  12.,  13.,
        14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,  24.,  25.,
        26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,  36.,  37.,
        38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,  48.,  49.,
        50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,  60.,  61.,
        62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,  72.,  73.,
        74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,  84.,  85.,
        86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94.,  95.,  96.,  97.,
        98.,  99., 100.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT11&#x27; &#x27;AT12&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;</div><input id='attrs-e83a6e3e-5cdf-4ae8-b1fd-ffba9d813bf9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e83a6e3e-5cdf-4ae8-b1fd-ffba9d813bf9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-724ff8d6-94b9-4a29-8f33-0e103ec34c23' class='xr-var-data-in' type='checkbox'><label for='data-724ff8d6-94b9-4a29-8f33-0e103ec34c23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT11&#x27;, &#x27;AT12&#x27;, &#x27;AT13&#x27;, ..., &#x27;UKM8&#x27;, &#x27;UKM9&#x27;, &#x27;UKN0&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sex</span></div><div class='xr-var-dims'>(sex)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;F&#x27; &#x27;M&#x27;</div><input id='attrs-cad62634-5993-45cb-8bc0-f27870b45d7b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cad62634-5993-45cb-8bc0-f27870b45d7b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5c92785-6d1c-43e8-beb3-62cf86650176' class='xr-var-data-in' type='checkbox'><label for='data-e5c92785-6d1c-43e8-beb3-62cf86650176' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;F&#x27;, &#x27;M&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a4f9a1fa-08b7-44a1-bca5-92fb56dec640' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a4f9a1fa-08b7-44a1-bca5-92fb56dec640' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lagged_mortality</span></div><div class='xr-var-dims'>(year, age, nuts2, sex)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-eb335855-e786-4db9-a16a-bb165d884dc6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb335855-e786-4db9-a16a-bb165d884dc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ae2ee47-3990-476b-990f-8286b80332d1' class='xr-var-data-in' type='checkbox'><label for='data-7ae2ee47-3990-476b-990f-8286b80332d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[           nan,            nan],
         [           nan,            nan],
         [           nan,            nan],
         ...,
         [           nan,            nan],
         [           nan,            nan],
         [           nan,            nan]],

        [[           nan,            nan],
         [           nan,            nan],
         [           nan,            nan],
         ...,
         [           nan,            nan],
         [           nan,            nan],
         [           nan,            nan]],

        [[           nan,            nan],
         [           nan,            nan],
         [           nan,            nan],
         ...,
...
         ...,
         [           nan,            nan],
         [           nan,            nan],
         [           nan,            nan]],

        [[4.59459459e-01, 1.00000000e+00],
         [4.08256881e-01, 4.20000000e-01],
         [3.94636015e-01, 4.82758621e-01],
         ...,
         [           nan,            nan],
         [           nan,            nan],
         [           nan,            nan]],

        [[2.63157895e-01,            nan],
         [4.78723404e-01, 6.84210526e-01],
         [4.25925926e-01, 6.00000000e-01],
         ...,
         [           nan,            nan],
         [           nan,            nan],
         [           nan,            nan]]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-394eaf62-b712-492c-b9e1-8f931a8b012f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-394eaf62-b712-492c-b9e1-8f931a8b012f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</div>



<div id="outline-container-org0e2fc9d" class="outline-4">
<h4 id="org0e2fc9d"><span class="section-number-4">3.2.3.</span> Poverty measures</h4>
<div class="outline-text-4" id="text-3-2-3">
</div>
<ol class="org-ol">
<li><a id="orgf8bfc59"></a>Severe material deprivation rate by NUTS 2 regions [TGS00104]<br />
<div class="outline-text-5" id="text-3-2-3-1">
<ul class="org-ul">
<li>link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/tgs00104/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/tgs00104/default/table?lang=en</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'tgs00104'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'nuts2'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df = df[(df.unit == <span style="color: #c3e88d;">"PC"</span>)]
df.drop([<span style="color: #c3e88d;">"unit"</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'nuts'</span>] = [<span style="color: #82aaff;">len</span>(x)-2 <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df.nuts2]
df = df[df.nuts == 2]
df.drop(<span style="color: #c3e88d;">'nuts'</span>,axis=1,inplace=<span style="color: #f78c6c;">True</span>)

df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'nuts2'</span>],
                        value_vars=np.arange(2009,2021),
                        var_name=<span style="color: #c3e88d;">'year'</span>,\
             value_name=<span style="color: #c3e88d;">'percentage_material_deprivation'</span>)
df.set_index([<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'year'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>percentage_material_deprivation</th>
    </tr>
    <tr>
      <th>nuts2</th>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL01</th>
      <th>2009</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AL02</th>
      <th>2009</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AL03</th>
      <th>2009</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AT11</th>
      <th>2009</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AT12</th>
      <th>2009</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds_material_deprivation</span> = df.to_xarray()
ds_material_deprivation.to_netcdf(<span style="color: #c3e88d;">"./data/material_deprivation_nuts_2.nc"</span>)
ds_material_deprivation
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                          (nuts2: 179, year: 12)
Coordinates:
  * nuts2                            (nuts2) object &#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;SK04&#x27;
  * year                             (year) int64 2009 2010 2011 ... 2019 2020
Data variables:
    percentage_material_deprivation  (nuts2, year) float64 nan nan ... 9.6 8.3</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-60ca8307-3f41-47b2-98de-8d309d5e40c3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-60ca8307-3f41-47b2-98de-8d309d5e40c3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>nuts2</span>: 179</li><li><span class='xr-has-index'>year</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e265b081-1fcc-4bac-a8c4-0ad9a24d9c65' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e265b081-1fcc-4bac-a8c4-0ad9a24d9c65' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;SK03&#x27; &#x27;SK04&#x27;</div><input id='attrs-5dfd14bc-1c2d-4a73-b06c-5e48d5b2ec5a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5dfd14bc-1c2d-4a73-b06c-5e48d5b2ec5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b95a3807-5b27-4013-b0f0-975e759442c1' class='xr-var-data-in' type='checkbox'><label for='data-b95a3807-5b27-4013-b0f0-975e759442c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AL01&#x27;, &#x27;AL02&#x27;, &#x27;AL03&#x27;, &#x27;AT11&#x27;, &#x27;AT12&#x27;, &#x27;AT13&#x27;, &#x27;AT21&#x27;, &#x27;AT22&#x27;, &#x27;AT31&#x27;,
       &#x27;AT32&#x27;, &#x27;AT33&#x27;, &#x27;AT34&#x27;, &#x27;BG31&#x27;, &#x27;BG32&#x27;, &#x27;BG33&#x27;, &#x27;BG34&#x27;, &#x27;BG41&#x27;, &#x27;BG42&#x27;,
       &#x27;CH01&#x27;, &#x27;CH02&#x27;, &#x27;CH03&#x27;, &#x27;CH04&#x27;, &#x27;CH05&#x27;, &#x27;CH06&#x27;, &#x27;CH07&#x27;, &#x27;CZ01&#x27;, &#x27;CZ02&#x27;,
       &#x27;CZ03&#x27;, &#x27;CZ04&#x27;, &#x27;CZ05&#x27;, &#x27;CZ06&#x27;, &#x27;CZ07&#x27;, &#x27;CZ08&#x27;, &#x27;DK01&#x27;, &#x27;DK02&#x27;, &#x27;DK03&#x27;,
       &#x27;DK04&#x27;, &#x27;DK05&#x27;, &#x27;EL30&#x27;, &#x27;EL41&#x27;, &#x27;EL42&#x27;, &#x27;EL43&#x27;, &#x27;EL51&#x27;, &#x27;EL52&#x27;, &#x27;EL53&#x27;,
       &#x27;EL54&#x27;, &#x27;EL61&#x27;, &#x27;EL62&#x27;, &#x27;EL63&#x27;, &#x27;EL64&#x27;, &#x27;EL65&#x27;, &#x27;ES11&#x27;, &#x27;ES12&#x27;, &#x27;ES13&#x27;,
       &#x27;ES21&#x27;, &#x27;ES22&#x27;, &#x27;ES23&#x27;, &#x27;ES24&#x27;, &#x27;ES30&#x27;, &#x27;ES41&#x27;, &#x27;ES42&#x27;, &#x27;ES43&#x27;, &#x27;ES51&#x27;,
       &#x27;ES52&#x27;, &#x27;ES53&#x27;, &#x27;ES61&#x27;, &#x27;ES62&#x27;, &#x27;ES63&#x27;, &#x27;ES64&#x27;, &#x27;ES70&#x27;, &#x27;FI1B&#x27;, &#x27;FI1C&#x27;,
       &#x27;FI1D&#x27;, &#x27;HR03&#x27;, &#x27;HR04&#x27;, &#x27;HU10&#x27;, &#x27;HU11&#x27;, &#x27;HU12&#x27;, &#x27;HU21&#x27;, &#x27;HU22&#x27;, &#x27;HU23&#x27;,
       &#x27;HU31&#x27;, &#x27;HU32&#x27;, &#x27;HU33&#x27;, &#x27;IE01&#x27;, &#x27;IE02&#x27;, &#x27;IE04&#x27;, &#x27;IE05&#x27;, &#x27;IE06&#x27;, &#x27;ITC1&#x27;,
       &#x27;ITC2&#x27;, &#x27;ITC3&#x27;, &#x27;ITC4&#x27;, &#x27;ITF1&#x27;, &#x27;ITF2&#x27;, &#x27;ITF3&#x27;, &#x27;ITF4&#x27;, &#x27;ITF5&#x27;, &#x27;ITF6&#x27;,
       &#x27;ITG1&#x27;, &#x27;ITG2&#x27;, &#x27;ITH1&#x27;, &#x27;ITH2&#x27;, &#x27;ITH3&#x27;, &#x27;ITH4&#x27;, &#x27;ITH5&#x27;, &#x27;ITI1&#x27;, &#x27;ITI2&#x27;,
       &#x27;ITI3&#x27;, &#x27;ITI4&#x27;, &#x27;LT01&#x27;, &#x27;LT02&#x27;, &#x27;NL11&#x27;, &#x27;NL12&#x27;, &#x27;NL13&#x27;, &#x27;NL21&#x27;, &#x27;NL22&#x27;,
       &#x27;NL23&#x27;, &#x27;NL31&#x27;, &#x27;NL32&#x27;, &#x27;NL33&#x27;, &#x27;NL34&#x27;, &#x27;NL41&#x27;, &#x27;NL42&#x27;, &#x27;NO01&#x27;, &#x27;NO02&#x27;,
       &#x27;NO03&#x27;, &#x27;NO04&#x27;, &#x27;NO05&#x27;, &#x27;NO06&#x27;, &#x27;NO07&#x27;, &#x27;PL21&#x27;, &#x27;PL22&#x27;, &#x27;PL41&#x27;, &#x27;PL42&#x27;,
       &#x27;PL43&#x27;, &#x27;PL51&#x27;, &#x27;PL52&#x27;, &#x27;PL61&#x27;, &#x27;PL62&#x27;, &#x27;PL63&#x27;, &#x27;PL71&#x27;, &#x27;PL72&#x27;, &#x27;PL81&#x27;,
       &#x27;PL82&#x27;, &#x27;PL84&#x27;, &#x27;PL91&#x27;, &#x27;PL92&#x27;, &#x27;PT11&#x27;, &#x27;PT15&#x27;, &#x27;PT16&#x27;, &#x27;PT17&#x27;, &#x27;PT18&#x27;,
       &#x27;PT20&#x27;, &#x27;PT30&#x27;, &#x27;RO11&#x27;, &#x27;RO12&#x27;, &#x27;RO21&#x27;, &#x27;RO22&#x27;, &#x27;RO31&#x27;, &#x27;RO32&#x27;, &#x27;RO41&#x27;,
       &#x27;RO42&#x27;, &#x27;SE11&#x27;, &#x27;SE12&#x27;, &#x27;SE21&#x27;, &#x27;SE22&#x27;, &#x27;SE23&#x27;, &#x27;SE31&#x27;, &#x27;SE32&#x27;, &#x27;SE33&#x27;,
       &#x27;SI01&#x27;, &#x27;SI02&#x27;, &#x27;SI03&#x27;, &#x27;SI04&#x27;, &#x27;SK01&#x27;, &#x27;SK02&#x27;, &#x27;SK03&#x27;, &#x27;SK04&#x27;],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2009 2010 2011 ... 2018 2019 2020</div><input id='attrs-bf77da31-1617-4704-933b-ed6ef6be28b3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf77da31-1617-4704-933b-ed6ef6be28b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2578d56-40f1-460e-8d30-43b5c2ae8c93' class='xr-var-data-in' type='checkbox'><label for='data-e2578d56-40f1-460e-8d30-43b5c2ae8c93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bceb7383-8569-42c9-ba98-f61872db456b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bceb7383-8569-42c9-ba98-f61872db456b' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>percentage_material_deprivation</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 10.0 9.6 8.3</div><input id='attrs-aa8ffff8-72dc-4df7-8d24-db3b2e367d17' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa8ffff8-72dc-4df7-8d24-db3b2e367d17' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba10dca9-3012-417d-a9bf-54fc58b34dbe' class='xr-var-data-in' type='checkbox'><label for='data-ba10dca9-3012-417d-a9bf-54fc58b34dbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 38.6, 38.5, 36.6],
       [ nan,  nan,  nan, ..., 40.4, 37.7, 35.1],
       [ nan,  nan,  nan, ..., 35.3, 34.9, 32.2],
       ...,
       [10.3,  9.8,  8.6, ...,  4.2,  5.6,  3.6],
       [11.1, 10.6, 10.7, ...,  9.1, 10.6,  8.1],
       [13.5, 15. , 12.3, ..., 10. ,  9.6,  8.3]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ad5c6462-0485-4b8b-a7b5-86037f59a0ab' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ad5c6462-0485-4b8b-a7b5-86037f59a0ab' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</li>

<li><a id="orga2e87a2"></a>At-risk-of-poverty rate by NUTS 2 regions [TGS00103]<br />
<div class="outline-text-5" id="text-3-2-3-2">
<ul class="org-ul">
<li>link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/tgs00103/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/tgs00103/default/table?lang=en</a></li>
</ul>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'tgs00103'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'nuts2'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df = df[(df.unit == <span style="color: #c3e88d;">"PC_POP"</span>)]
df.drop([<span style="color: #c3e88d;">"unit"</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'nuts'</span>] = [<span style="color: #82aaff;">len</span>(x)-2 <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df.nuts2]
df = df[df.nuts == 2]
df.drop(<span style="color: #c3e88d;">'nuts'</span>,axis=1,inplace=<span style="color: #f78c6c;">True</span>)

df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'nuts2'</span>],
                        value_vars=np.arange(2010,2022),
                        var_name=<span style="color: #c3e88d;">'year'</span>,
             value_name=<span style="color: #c3e88d;">'at risk of poverty'</span>)
df.set_index([<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'year'</span>],inplace=<span style="color: #f78c6c;">True</span>)
df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>at risk of poverty</th>
    </tr>
    <tr>
      <th>nuts2</th>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL01</th>
      <th>2010</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AL02</th>
      <th>2010</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AL03</th>
      <th>2010</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BG31</th>
      <th>2010</th>
      <td>30.5</td>
    </tr>
    <tr>
      <th>BG32</th>
      <th>2010</th>
      <td>28.8</td>
    </tr>
  </tbody>
</table>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds_at_risk_of_poverty</span> = df.to_xarray()
ds_at_risk_of_poverty.to_netcdf(<span style="color: #c3e88d;">"./data/at_risk_of_poverty_nuts_2.nc"</span>)
ds_at_risk_of_poverty
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:             (nuts2: 173, year: 12)
Coordinates:
  * nuts2               (nuts2) object &#x27;AL01&#x27; &#x27;AL02&#x27; &#x27;AL03&#x27; ... &#x27;SK03&#x27; &#x27;SK04&#x27;
  * year                (year) int64 2010 2011 2012 2013 ... 2018 2019 2020 2021
Data variables:
    at risk of poverty  (nuts2, year) float64 nan nan nan nan ... 17.0 16.5 nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3b841719-a99a-4f99-9f47-e816a323be74' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3b841719-a99a-4f99-9f47-e816a323be74' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>nuts2</span>: 173</li><li><span class='xr-has-index'>year</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-1b2ce0c0-6dcd-4d6d-947c-5e1ba53bd8e4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1b2ce0c0-6dcd-4d6d-947c-5e1ba53bd8e4' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;SK03&#x27; &#x27;SK04&#x27;</div><input id='attrs-6a67b206-2ef4-460f-8a16-d4709df942f0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6a67b206-2ef4-460f-8a16-d4709df942f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1271b3a6-3cd6-46c7-ae59-45f518dbe670' class='xr-var-data-in' type='checkbox'><label for='data-1271b3a6-3cd6-46c7-ae59-45f518dbe670' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AL01&#x27;, &#x27;AL02&#x27;, &#x27;AL03&#x27;, &#x27;BG31&#x27;, &#x27;BG32&#x27;, &#x27;BG33&#x27;, &#x27;BG34&#x27;, &#x27;BG41&#x27;, &#x27;BG42&#x27;,
       &#x27;CH01&#x27;, &#x27;CH02&#x27;, &#x27;CH03&#x27;, &#x27;CH04&#x27;, &#x27;CH05&#x27;, &#x27;CH06&#x27;, &#x27;CH07&#x27;, &#x27;CZ01&#x27;, &#x27;CZ02&#x27;,
       &#x27;CZ03&#x27;, &#x27;CZ04&#x27;, &#x27;CZ05&#x27;, &#x27;CZ06&#x27;, &#x27;CZ07&#x27;, &#x27;CZ08&#x27;, &#x27;DK01&#x27;, &#x27;DK02&#x27;, &#x27;DK03&#x27;,
       &#x27;DK04&#x27;, &#x27;DK05&#x27;, &#x27;EL30&#x27;, &#x27;EL41&#x27;, &#x27;EL42&#x27;, &#x27;EL43&#x27;, &#x27;EL51&#x27;, &#x27;EL52&#x27;, &#x27;EL53&#x27;,
       &#x27;EL54&#x27;, &#x27;EL61&#x27;, &#x27;EL62&#x27;, &#x27;EL63&#x27;, &#x27;EL64&#x27;, &#x27;EL65&#x27;, &#x27;ES11&#x27;, &#x27;ES12&#x27;, &#x27;ES13&#x27;,
       &#x27;ES21&#x27;, &#x27;ES22&#x27;, &#x27;ES23&#x27;, &#x27;ES24&#x27;, &#x27;ES30&#x27;, &#x27;ES41&#x27;, &#x27;ES42&#x27;, &#x27;ES43&#x27;, &#x27;ES51&#x27;,
       &#x27;ES52&#x27;, &#x27;ES53&#x27;, &#x27;ES61&#x27;, &#x27;ES62&#x27;, &#x27;ES63&#x27;, &#x27;ES64&#x27;, &#x27;ES70&#x27;, &#x27;FI1B&#x27;, &#x27;FI1C&#x27;,
       &#x27;FI1D&#x27;, &#x27;HR02&#x27;, &#x27;HR03&#x27;, &#x27;HR04&#x27;, &#x27;HR05&#x27;, &#x27;HR06&#x27;, &#x27;HU10&#x27;, &#x27;HU11&#x27;, &#x27;HU12&#x27;,
       &#x27;HU21&#x27;, &#x27;HU22&#x27;, &#x27;HU23&#x27;, &#x27;HU31&#x27;, &#x27;HU32&#x27;, &#x27;HU33&#x27;, &#x27;IE01&#x27;, &#x27;IE02&#x27;, &#x27;IE04&#x27;,
       &#x27;IE05&#x27;, &#x27;IE06&#x27;, &#x27;ITC1&#x27;, &#x27;ITC2&#x27;, &#x27;ITC3&#x27;, &#x27;ITC4&#x27;, &#x27;ITF1&#x27;, &#x27;ITF2&#x27;, &#x27;ITF3&#x27;,
       &#x27;ITF4&#x27;, &#x27;ITF5&#x27;, &#x27;ITF6&#x27;, &#x27;ITG1&#x27;, &#x27;ITG2&#x27;, &#x27;ITH1&#x27;, &#x27;ITH2&#x27;, &#x27;ITH3&#x27;, &#x27;ITH4&#x27;,
       &#x27;ITH5&#x27;, &#x27;ITI1&#x27;, &#x27;ITI2&#x27;, &#x27;ITI3&#x27;, &#x27;ITI4&#x27;, &#x27;LT01&#x27;, &#x27;LT02&#x27;, &#x27;NL11&#x27;, &#x27;NL12&#x27;,
       &#x27;NL13&#x27;, &#x27;NL21&#x27;, &#x27;NL22&#x27;, &#x27;NL23&#x27;, &#x27;NL31&#x27;, &#x27;NL32&#x27;, &#x27;NL33&#x27;, &#x27;NL34&#x27;, &#x27;NL41&#x27;,
       &#x27;NL42&#x27;, &#x27;NO01&#x27;, &#x27;NO02&#x27;, &#x27;NO03&#x27;, &#x27;NO04&#x27;, &#x27;NO05&#x27;, &#x27;NO06&#x27;, &#x27;NO07&#x27;, &#x27;PL21&#x27;,
       &#x27;PL22&#x27;, &#x27;PL41&#x27;, &#x27;PL42&#x27;, &#x27;PL43&#x27;, &#x27;PL51&#x27;, &#x27;PL52&#x27;, &#x27;PL61&#x27;, &#x27;PL62&#x27;, &#x27;PL63&#x27;,
       &#x27;PL71&#x27;, &#x27;PL72&#x27;, &#x27;PL81&#x27;, &#x27;PL82&#x27;, &#x27;PL84&#x27;, &#x27;PL91&#x27;, &#x27;PL92&#x27;, &#x27;PT11&#x27;, &#x27;PT15&#x27;,
       &#x27;PT16&#x27;, &#x27;PT17&#x27;, &#x27;PT18&#x27;, &#x27;PT20&#x27;, &#x27;PT30&#x27;, &#x27;RO11&#x27;, &#x27;RO12&#x27;, &#x27;RO21&#x27;, &#x27;RO22&#x27;,
       &#x27;RO31&#x27;, &#x27;RO32&#x27;, &#x27;RO41&#x27;, &#x27;RO42&#x27;, &#x27;SE11&#x27;, &#x27;SE12&#x27;, &#x27;SE21&#x27;, &#x27;SE22&#x27;, &#x27;SE23&#x27;,
       &#x27;SE31&#x27;, &#x27;SE32&#x27;, &#x27;SE33&#x27;, &#x27;SI01&#x27;, &#x27;SI02&#x27;, &#x27;SI03&#x27;, &#x27;SI04&#x27;, &#x27;SK01&#x27;, &#x27;SK02&#x27;,
       &#x27;SK03&#x27;, &#x27;SK04&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2010 2011 2012 ... 2019 2020 2021</div><input id='attrs-462f4ad8-99d7-4427-9684-d87d82b68f92' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-462f4ad8-99d7-4427-9684-d87d82b68f92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0cab462-4f7e-4b50-9c9d-ecb114ab8429' class='xr-var-data-in' type='checkbox'><label for='data-d0cab462-4f7e-4b50-9c9d-ecb114ab8429' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f66dda71-5615-4a8f-9449-bfd325bf6fb1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f66dda71-5615-4a8f-9449-bfd325bf6fb1' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>at risk of poverty</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 17.0 16.5 nan</div><input id='attrs-b5374d32-0a2d-4639-938f-d6e92e85164e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b5374d32-0a2d-4639-938f-d6e92e85164e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c88e8b0-989e-4d39-a189-a3dc90499e25' class='xr-var-data-in' type='checkbox'><label for='data-7c88e8b0-989e-4d39-a189-a3dc90499e25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 25.9, 25.1,  nan],
       [ nan,  nan,  nan, ..., 22.7, 21.3,  nan],
       [ nan,  nan,  nan, ..., 20.8, 19.5,  nan],
       ...,
       [10.3, 11.4, 11.9, ...,  7.4,  7.1,  nan],
       [13.1, 13.1, 14.1, ..., 15.6, 14.8,  nan],
       [15.8, 16.9, 16.7, ..., 17. , 16.5,  nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bfb5c5ca-e29c-4617-ab74-112fbf771599' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bfb5c5ca-e29c-4617-ab74-112fbf771599' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org9721376" class="outline-4">
<h4 id="org9721376"><span class="section-number-4">3.2.4.</span> unmet needs</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
Self-reported unmet needs for medical examination by main reason declared and NUTS 2 regions
</p>

<ul class="org-ul">
<li>link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_silc_08_r/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_silc_08_r/default/table?lang=en</a></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">value</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">TOOEXP</td>
<td class="org-left">Too expensive</td>
</tr>

<tr>
<td class="org-left">TOOFAR</td>
<td class="org-left">Too far to travel</td>
</tr>

<tr>
<td class="org-left">TOOEFW</td>
<td class="org-left">Too expensive or too far to travel or waiting list</td>
</tr>

<tr>
<td class="org-left">NOTIME</td>
<td class="org-left">No time</td>
</tr>

<tr>
<td class="org-left">NO_UNMET</td>
<td class="org-left">No unmet needs to declare</td>
</tr>

<tr>
<td class="org-left">NOKNOW</td>
<td class="org-left">Didn't know any good doctor or specialist</td>
</tr>

<tr>
<td class="org-left">WAITING</td>
<td class="org-left">Waiting list</td>
</tr>

<tr>
<td class="org-left">FEAR</td>
<td class="org-left">Fear of doctor, hospital, examination or treatment</td>
</tr>

<tr>
<td class="org-left">HOPING</td>
<td class="org-left">Wanted to wait and see if problem got better on its own</td>
</tr>

<tr>
<td class="org-left">OTH</td>
<td class="org-left">Other</td>
</tr>
</tbody>
</table>

<p>
We drop the values <code>NO_UNMET</code> and <code>OTH</code>. The former is dropped because we are interested in unmet medical needs. The latter because the reason is unclear.
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = eurostat.get_data_df(<span style="color: #c3e88d;">'hlth_silc_08_r'</span>)
df.rename({<span style="color: #c3e88d;">'geo\\time'</span>:<span style="color: #c3e88d;">'nuts2'</span>},inplace=<span style="color: #f78c6c;">True</span>,axis=1)
df.drop([<span style="color: #c3e88d;">"unit"</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'nuts'</span>] = [<span style="color: #82aaff;">len</span>(x)-2 <span style="color: #89DDFF;">for</span> x <span style="color: #89DDFF;">in</span> df.nuts2]
df = df[df.nuts == 2]
df.drop(<span style="color: #c3e88d;">'nuts'</span>,axis=1,inplace=<span style="color: #f78c6c;">True</span>)
columns = [<span style="color: #c3e88d;">'FEAR'</span>,<span style="color: #c3e88d;">'TOOEXP'</span>,<span style="color: #c3e88d;">'TOOFAR'</span>,<span style="color: #c3e88d;">'WAITING'</span>,\
           <span style="color: #c3e88d;">'HOPING'</span>, <span style="color: #c3e88d;">'NOTIME'</span>, <span style="color: #c3e88d;">'NOKNOW'</span>]
df=df[df.reason.isin(columns)]
df = pd.melt(df,id_vars=[<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'reason'</span>],
                        value_vars=np.arange(2009,2021),
                        var_name=<span style="color: #c3e88d;">'year'</span>,\
             value_name=<span style="color: #c3e88d;">'unmet needs'</span>)
df.set_index([<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'reason'</span>],inplace=<span style="color: #f78c6c;">True</span>)

df = df.unstack()
df.columns = df.columns.droplevel()
df[<span style="color: #c3e88d;">'UNMET'</span>] = df[columns].<span style="color: #82aaff;">sum</span>(axis=1)
df.drop([<span style="color: #c3e88d;">'FEAR'</span>,<span style="color: #c3e88d;">'TOOFAR'</span>,<span style="color: #c3e88d;">'WAITING'</span>,\
           <span style="color: #c3e88d;">'HOPING'</span>, <span style="color: #c3e88d;">'NOTIME'</span>, <span style="color: #c3e88d;">'NOKNOW'</span>],axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df.tail()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>reason</th>
      <th>TOOEXP</th>
      <th>UNMET</th>
    </tr>
    <tr>
      <th>nuts2</th>
      <th>year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">SK04</th>
      <th>2016</th>
      <td>0.5</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>0.2</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>0.4</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>0.4</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>0.2</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">ds_unmet_needs</span> = df.to_xarray()
ds_unmet_needs.to_netcdf(<span style="color: #c3e88d;">"./data/unmet_needs_nuts_2.nc"</span>)
ds_unmet_needs
</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (nuts2: 106, year: 12)
Coordinates:
  * nuts2    (nuts2) object &#x27;AL01&#x27; &#x27;AL02&#x27; &#x27;AL03&#x27; &#x27;BG31&#x27; ... &#x27;SK02&#x27; &#x27;SK03&#x27; &#x27;SK04&#x27;
  * year     (year) int64 2009 2010 2011 2012 2013 ... 2016 2017 2018 2019 2020
Data variables:
    TOOEXP   (nuts2, year) float64 nan nan nan nan nan ... 0.5 0.2 0.4 0.4 0.2
    UNMET    (nuts2, year) float64 0.0 0.0 0.0 0.0 0.0 ... 7.4 5.5 6.2 6.6 6.0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4d3c5701-6df3-426f-9c98-919ac3aafeba' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4d3c5701-6df3-426f-9c98-919ac3aafeba' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>nuts2</span>: 106</li><li><span class='xr-has-index'>year</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-da190636-6545-4523-a5d0-6a99749dbbbd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-da190636-6545-4523-a5d0-6a99749dbbbd' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;SK03&#x27; &#x27;SK04&#x27;</div><input id='attrs-43b108df-3a7b-458b-a033-630ae2c730e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43b108df-3a7b-458b-a033-630ae2c730e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-530c4b14-17d5-4a39-a805-b6e8edb239d1' class='xr-var-data-in' type='checkbox'><label for='data-530c4b14-17d5-4a39-a805-b6e8edb239d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AL01&#x27;, &#x27;AL02&#x27;, &#x27;AL03&#x27;, &#x27;BG31&#x27;, &#x27;BG32&#x27;, &#x27;BG33&#x27;, &#x27;BG34&#x27;, &#x27;BG41&#x27;, &#x27;BG42&#x27;,
       &#x27;CH01&#x27;, &#x27;CH02&#x27;, &#x27;CH03&#x27;, &#x27;CH04&#x27;, &#x27;CH05&#x27;, &#x27;CH06&#x27;, &#x27;CH07&#x27;, &#x27;DK01&#x27;, &#x27;DK02&#x27;,
       &#x27;DK03&#x27;, &#x27;DK04&#x27;, &#x27;DK05&#x27;, &#x27;EL30&#x27;, &#x27;EL41&#x27;, &#x27;EL42&#x27;, &#x27;EL43&#x27;, &#x27;EL51&#x27;, &#x27;EL52&#x27;,
       &#x27;EL53&#x27;, &#x27;EL54&#x27;, &#x27;EL61&#x27;, &#x27;EL62&#x27;, &#x27;EL63&#x27;, &#x27;EL64&#x27;, &#x27;EL65&#x27;, &#x27;FI1B&#x27;, &#x27;FI1C&#x27;,
       &#x27;FI1D&#x27;, &#x27;HR02&#x27;, &#x27;HR03&#x27;, &#x27;HR04&#x27;, &#x27;HR05&#x27;, &#x27;HR06&#x27;, &#x27;HU10&#x27;, &#x27;HU11&#x27;, &#x27;HU12&#x27;,
       &#x27;HU21&#x27;, &#x27;HU22&#x27;, &#x27;HU23&#x27;, &#x27;HU31&#x27;, &#x27;HU32&#x27;, &#x27;HU33&#x27;, &#x27;IE01&#x27;, &#x27;IE02&#x27;, &#x27;IE04&#x27;,
       &#x27;IE05&#x27;, &#x27;IE06&#x27;, &#x27;LT01&#x27;, &#x27;LT02&#x27;, &#x27;NO01&#x27;, &#x27;NO02&#x27;, &#x27;NO03&#x27;, &#x27;NO04&#x27;, &#x27;NO05&#x27;,
       &#x27;NO06&#x27;, &#x27;NO07&#x27;, &#x27;PL21&#x27;, &#x27;PL22&#x27;, &#x27;PL41&#x27;, &#x27;PL42&#x27;, &#x27;PL43&#x27;, &#x27;PL51&#x27;, &#x27;PL52&#x27;,
       &#x27;PL61&#x27;, &#x27;PL62&#x27;, &#x27;PL63&#x27;, &#x27;PL71&#x27;, &#x27;PL72&#x27;, &#x27;PL81&#x27;, &#x27;PL82&#x27;, &#x27;PL84&#x27;, &#x27;PL91&#x27;,
       &#x27;PL92&#x27;, &#x27;RO11&#x27;, &#x27;RO12&#x27;, &#x27;RO21&#x27;, &#x27;RO22&#x27;, &#x27;RO31&#x27;, &#x27;RO32&#x27;, &#x27;RO41&#x27;, &#x27;RO42&#x27;,
       &#x27;SE11&#x27;, &#x27;SE12&#x27;, &#x27;SE21&#x27;, &#x27;SE22&#x27;, &#x27;SE23&#x27;, &#x27;SE31&#x27;, &#x27;SE32&#x27;, &#x27;SE33&#x27;, &#x27;SI01&#x27;,
       &#x27;SI02&#x27;, &#x27;SI03&#x27;, &#x27;SI04&#x27;, &#x27;SK01&#x27;, &#x27;SK02&#x27;, &#x27;SK03&#x27;, &#x27;SK04&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2009 2010 2011 ... 2018 2019 2020</div><input id='attrs-aa5d02e9-a69f-454d-a425-4516b764d4eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa5d02e9-a69f-454d-a425-4516b764d4eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-435c5da4-1985-456e-adf1-2b32ebc21c96' class='xr-var-data-in' type='checkbox'><label for='data-435c5da4-1985-456e-adf1-2b32ebc21c96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-acb009c3-7872-40f2-a438-3603c7a8a174' class='xr-section-summary-in' type='checkbox'  checked><label for='section-acb009c3-7872-40f2-a438-3603c7a8a174' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>TOOEXP</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 0.2 0.4 0.4 0.2</div><input id='attrs-f5ad9275-6dbb-4c2d-9950-9fe7b96bf841' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f5ad9275-6dbb-4c2d-9950-9fe7b96bf841' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51d06be8-a72c-4f37-b8d2-0488d2899f89' class='xr-var-data-in' type='checkbox'><label for='data-51d06be8-a72c-4f37-b8d2-0488d2899f89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 18.9, 21.8, 12. ],
       [ nan,  nan,  nan, ..., 12.3,  9.3,  7.6],
       [ nan,  nan,  nan, ..., 10.8, 11.6,  8.5],
       ...,
       [ 0.6,  0.8,  1. , ...,  0.4,  0.4,  0.7],
       [ 0.6,  0.6,  0.5, ...,  1.1,  1.1,  1.6],
       [ 0.7,  0.8,  0.8, ...,  0.4,  0.4,  0.2]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>UNMET</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 5.5 6.2 6.6 6.0</div><input id='attrs-825c4cd9-66cf-4143-a1dc-f2a9f3f2cbcf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-825c4cd9-66cf-4143-a1dc-f2a9f3f2cbcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-577e302f-e75f-45c6-808c-0cff5d50aa1b' class='xr-var-data-in' type='checkbox'><label for='data-577e302f-e75f-45c6-808c-0cff5d50aa1b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0. ,  0. ,  0. , ..., 26.1, 26.9, 19.8],
       [ 0. ,  0. ,  0. , ..., 20.6, 15. , 11.1],
       [ 0. ,  0. ,  0. , ..., 17.5, 24.4, 13.6],
       ...,
       [ 5.2,  5.7,  5.6, ...,  4. ,  3.7,  3. ],
       [ 3.6,  4.9,  4.6, ...,  9.9,  9.3, 13.5],
       [ 3.5,  4.4,  5.2, ...,  6.2,  6.6,  6. ]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b77cda2b-b737-4f74-a6b5-1d2f2799a80a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b77cda2b-b737-4f74-a6b5-1d2f2799a80a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>
</div>
</div>
</div>
</div>


<div id="outline-container-orgf970804" class="outline-2">
<h2 id="orgf970804"><span class="section-number-2">4.</span> Combining data</h2>
<div class="outline-text-2" id="text-4">
<p>
The sections below generate the datasets per variable. Once these datasets are generated, the code in this section merges all these variables into one <code>.csv</code> file.
</p>
</div>

<div id="outline-container-orga434508" class="outline-3">
<h3 id="orga434508"><span class="section-number-3">4.1.</span> nuts2 data</h3>
<div class="outline-text-3" id="text-4-1">
<p>
In this subsection, we merge the data at the NUTS 2 level.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #89DDFF;">from</span> glob <span style="color: #89DDFF;">import</span> glob
<span style="color: #ffcb6b;">ds_2</span> = xr.merge([xr.open_dataset(f) <span style="color: #89DDFF;">for</span> f <span style="color: #89DDFF;">in</span> glob(<span style="color: #c3e88d;">'./data/*.nc'</span>)])
ds_2

</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                          (age: 100, nuts2: 313, sex: 2, year: 32)
Coordinates:
  * age                              (age) float64 1.0 2.0 3.0 ... 99.0 100.0
  * nuts2                            (nuts2) object &#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;UKN0&#x27;
  * year                             (year) int64 1990 1991 1992 ... 2020 2021
  * sex                              (sex) object &#x27;F&#x27; &#x27;M&#x27;
Data variables:
    population                       (nuts2, year, sex, age) float64 nan ... nan
    at risk of poverty               (nuts2, year) float64 nan nan ... nan nan
    lagged_mortality                 (year, age, nuts2, sex) float64 nan ... nan
    percentage_material_deprivation  (nuts2, year) float64 nan nan ... nan nan
    deaths                           (nuts2, year, sex, age) float64 nan ... nan
    TOOEXP                           (nuts2, year) float64 nan nan ... nan nan
    UNMET                            (nuts2, year) float64 nan nan ... nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-becf13ca-3202-4501-a017-e0c5f3da56dc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-becf13ca-3202-4501-a017-e0c5f3da56dc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>age</span>: 100</li><li><span class='xr-has-index'>nuts2</span>: 313</li><li><span class='xr-has-index'>sex</span>: 2</li><li><span class='xr-has-index'>year</span>: 32</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d0f5ea88-8751-4f15-9cb7-18eb1415e71e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d0f5ea88-8751-4f15-9cb7-18eb1415e71e' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>age</span></div><div class='xr-var-dims'>(age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 98.0 99.0 100.0</div><input id='attrs-7ed47cff-9c33-4c08-ae6e-70d08d9d3500' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ed47cff-9c33-4c08-ae6e-70d08d9d3500' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36507de2-11d2-4cd4-87e1-60119eb8ffcc' class='xr-var-data-in' type='checkbox'><label for='data-36507de2-11d2-4cd4-87e1-60119eb8ffcc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,  12.,
        13.,  14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,  24.,
        25.,  26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,  36.,
        37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,  48.,
        49.,  50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,  60.,
        61.,  62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,  72.,
        73.,  74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,  84.,
        85.,  86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94.,  95.,  96.,
        97.,  98.,  99., 100.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>nuts2</span></div><div class='xr-var-dims'>(nuts2)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AL01&#x27; &#x27;AL02&#x27; ... &#x27;UKM9&#x27; &#x27;UKN0&#x27;</div><input id='attrs-35b816c6-75f8-4096-a41f-3e513d537480' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-35b816c6-75f8-4096-a41f-3e513d537480' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db55e2cd-c876-4a69-be0a-8cdd8d304052' class='xr-var-data-in' type='checkbox'><label for='data-db55e2cd-c876-4a69-be0a-8cdd8d304052' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AL01&#x27;, &#x27;AL02&#x27;, &#x27;AL03&#x27;, ..., &#x27;UKM8&#x27;, &#x27;UKM9&#x27;, &#x27;UKN0&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1990 1991 1992 ... 2019 2020 2021</div><input id='attrs-0871280d-be4c-4d72-ad1b-a8ddd5632d31' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0871280d-be4c-4d72-ad1b-a8ddd5632d31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cdda7035-9a30-4957-8276-ed71688367ca' class='xr-var-data-in' type='checkbox'><label for='data-cdda7035-9a30-4957-8276-ed71688367ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001,
       2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013,
       2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sex</span></div><div class='xr-var-dims'>(sex)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;F&#x27; &#x27;M&#x27;</div><input id='attrs-173bb8b5-d91c-468b-9160-28af003f63a8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-173bb8b5-d91c-468b-9160-28af003f63a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9643ff3c-411d-418f-9c46-3633722dd5ae' class='xr-var-data-in' type='checkbox'><label for='data-9643ff3c-411d-418f-9c46-3633722dd5ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;F&#x27;, &#x27;M&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5ed3395b-d917-4cb3-8dc6-cd06a4612d77' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5ed3395b-d917-4cb3-8dc6-cd06a4612d77' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>population</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-cdfcb220-b5d9-4229-92ae-834e81f2fdc8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cdfcb220-b5d9-4229-92ae-834e81f2fdc8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e048466-ce8c-43b1-ac23-cc5de3a3840b' class='xr-var-data-in' type='checkbox'><label for='data-8e048466-ce8c-43b1-ac23-cc5de3a3840b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        ...,

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]]],

...

       [[[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[12594., 12486., 12690., ...,    nan,    nan,    nan],
         [13305., 13199., 13380., ...,    nan,    nan,    nan]],

        ...,

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

        [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
         [   nan,    nan,    nan, ...,    nan,    nan,    nan]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>at risk of poverty</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-eca04752-5f64-4241-aa03-89d078b52da3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eca04752-5f64-4241-aa03-89d078b52da3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-556767d2-17de-4308-9f4e-6006e8ceec14' class='xr-var-data-in' type='checkbox'><label for='data-556767d2-17de-4308-9f4e-6006e8ceec14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 25.9, 25.1,  nan],
       [ nan,  nan,  nan, ..., 22.7, 21.3,  nan],
       [ nan,  nan,  nan, ..., 20.8, 19.5,  nan],
       ...,
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lagged_mortality</span></div><div class='xr-var-dims'>(year, age, nuts2, sex)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-58ed8d4e-10ba-49c8-b538-1ab21ab335af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-58ed8d4e-10ba-49c8-b538-1ab21ab335af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf9feed8-1fdb-4030-a297-8dde586ab486' class='xr-var-data-in' type='checkbox'><label for='data-cf9feed8-1fdb-4030-a297-8dde586ab486' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[nan, nan],
         [nan, nan],
         [nan, nan],
         ...,
         [nan, nan],
         [nan, nan],
         [nan, nan]],

        [[nan, nan],
         [nan, nan],
         [nan, nan],
         ...,
         [nan, nan],
         [nan, nan],
         [nan, nan]],

        [[nan, nan],
         [nan, nan],
         [nan, nan],
         ...,
...
         ...,
         [nan, nan],
         [nan, nan],
         [nan, nan]],

        [[nan, nan],
         [nan, nan],
         [nan, nan],
         ...,
         [nan, nan],
         [nan, nan],
         [nan, nan]],

        [[nan, nan],
         [nan, nan],
         [nan, nan],
         ...,
         [nan, nan],
         [nan, nan],
         [nan, nan]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>percentage_material_deprivation</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-57d7a4a8-d4e5-477c-a6ea-f93edb26862f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-57d7a4a8-d4e5-477c-a6ea-f93edb26862f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b803d31-56b7-41f5-a46b-f7a35dfcd380' class='xr-var-data-in' type='checkbox'><label for='data-1b803d31-56b7-41f5-a46b-f7a35dfcd380' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 38.5, 36.6,  nan],
       [ nan,  nan,  nan, ..., 37.7, 35.1,  nan],
       [ nan,  nan,  nan, ..., 34.9, 32.2,  nan],
       ...,
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>deaths</span></div><div class='xr-var-dims'>(nuts2, year, sex, age)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-3694e108-8f6b-41e1-8ae7-f2faff07f9e6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3694e108-8f6b-41e1-8ae7-f2faff07f9e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-228f65fc-a8d0-48f1-84b8-baf7d56be0fd' class='xr-var-data-in' type='checkbox'><label for='data-228f65fc-a8d0-48f1-84b8-baf7d56be0fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        ...,

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]],

...

       [[[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        ...,

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]],

        [[nan, nan, nan, ..., nan, nan, nan],
         [nan, nan, nan, ..., nan, nan, nan]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TOOEXP</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-343af293-81f6-4e61-afe1-9047e13f4ac1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-343af293-81f6-4e61-afe1-9047e13f4ac1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82f7f727-723c-4fc6-9229-71371a6a5fef' class='xr-var-data-in' type='checkbox'><label for='data-82f7f727-723c-4fc6-9229-71371a6a5fef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 21.8, 12. ,  nan],
       [ nan,  nan,  nan, ...,  9.3,  7.6,  nan],
       [ nan,  nan,  nan, ..., 11.6,  8.5,  nan],
       ...,
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>UNMET</span></div><div class='xr-var-dims'>(nuts2, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-3ffa48e3-5721-4fb0-ad14-1edbc3640ca0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3ffa48e3-5721-4fb0-ad14-1edbc3640ca0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a6d18f9-b21c-432c-a0e0-14f3a0d83eb1' class='xr-var-data-in' type='checkbox'><label for='data-6a6d18f9-b21c-432c-a0e0-14f3a0d83eb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ nan,  nan,  nan, ..., 26.9, 19.8,  nan],
       [ nan,  nan,  nan, ..., 15. , 11.1,  nan],
       [ nan,  nan,  nan, ..., 24.4, 13.6,  nan],
       ...,
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan],
       [ nan,  nan,  nan, ...,  nan,  nan,  nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09a6c05b-7c3b-4697-9cf1-fe759754f24a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-09a6c05b-7c3b-4697-9cf1-fe759754f24a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = ds_2.to_dataframe()
df.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
df.rename({<span style="color: #c3e88d;">'level_0'</span>:<span style="color: #c3e88d;">'age'</span>,<span style="color: #c3e88d;">'level_1'</span>:<span style="color: #c3e88d;">'nuts2'</span>,<span style="color: #c3e88d;">'level_3'</span>:<span style="color: #c3e88d;">'year'</span>},\
          axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df[<span style="color: #c3e88d;">'country_code'</span>] = df[<span style="color: #c3e88d;">'nuts2'</span>].<span style="color: #82aaff;">str</span>.<span style="color: #82aaff;">slice</span>(0,2)
df[<span style="color: #c3e88d;">'nuts1'</span>] = df[<span style="color: #c3e88d;">'nuts2'</span>].<span style="color: #82aaff;">str</span>.<span style="color: #82aaff;">slice</span>(0,3)
df[<span style="color: #c3e88d;">'country'</span>] = df[<span style="color: #c3e88d;">'country_code'</span>].replace(eurostat_dictionary)
df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>nuts2</th>
      <th>sex</th>
      <th>year</th>
      <th>population</th>
      <th>at risk of poverty</th>
      <th>lagged_mortality</th>
      <th>percentage_material_deprivation</th>
      <th>deaths</th>
      <th>TOOEXP</th>
      <th>UNMET</th>
      <th>country_code</th>
      <th>nuts1</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>AL01</td>
      <td>F</td>
      <td>1990</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AL</td>
      <td>AL0</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>AL01</td>
      <td>F</td>
      <td>1991</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AL</td>
      <td>AL0</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>AL01</td>
      <td>F</td>
      <td>1992</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AL</td>
      <td>AL0</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>AL01</td>
      <td>F</td>
      <td>1993</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AL</td>
      <td>AL0</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>AL01</td>
      <td>F</td>
      <td>1994</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AL</td>
      <td>AL0</td>
      <td>Albania</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orge1b4690" class="outline-3">
<h3 id="orge1b4690"><span class="section-number-3">4.2.</span> country data</h3>
<div class="outline-text-3" id="text-4-2">
<p>
In this section, we add country level variables to the dataframe.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #89DDFF;">from</span> glob <span style="color: #89DDFF;">import</span> glob
<span style="color: #ffcb6b;">ds_c</span> = xr.merge([xr.open_dataset(f) <span style="color: #89DDFF;">for</span> f <span style="color: #89DDFF;">in</span> glob(<span style="color: #c3e88d;">'./data/country/*.nc'</span>)])
ds_c

</pre>
</div>

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                        (country: 33, country_code: 33, year: 28)
Coordinates:
  * year                           (year) int64 1992 1993 1994 ... 2018 2019
  * country                        (country) object &#x27;Austria&#x27; ... &#x27;United Kin...
  * country_code                   (country_code) object &#x27;AT&#x27; &#x27;BA&#x27; ... &#x27;SK&#x27; &#x27;UK&#x27;
Data variables:
    HF2_PC_CHE                     (country, country_code, year) float64 nan ...
    HF2_PPS_HAB                    (country, country_code, year) float64 nan ...
    HF3_PC_CHE                     (country, country_code, year) float64 nan ...
    HF3_PPS_HAB                    (country, country_code, year) float64 nan ...
    health expenditure per capita  (country, country_code, year) float64 nan ...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a0ea3cf1-297d-4681-a868-0481225df831' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a0ea3cf1-297d-4681-a868-0481225df831' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>country</span>: 33</li><li><span class='xr-has-index'>country_code</span>: 33</li><li><span class='xr-has-index'>year</span>: 28</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-20e62225-c4ef-42a7-8fdb-f07cf3b84937' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20e62225-c4ef-42a7-8fdb-f07cf3b84937' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1992 1993 1994 ... 2017 2018 2019</div><input id='attrs-6283edc2-83b4-4987-af4e-c92b764527e2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6283edc2-83b4-4987-af4e-c92b764527e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd20e2d6-786a-44d7-ba62-b115e0099e56' class='xr-var-data-in' type='checkbox'><label for='data-fd20e2d6-786a-44d7-ba62-b115e0099e56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country</span></div><div class='xr-var-dims'>(country)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;Austria&#x27; ... &#x27;United Kingdom&#x27;</div><input id='attrs-60c63990-08cd-4dcb-b819-e9db310fc29e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-60c63990-08cd-4dcb-b819-e9db310fc29e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-91565c82-a840-42a4-83cc-cd2ef603f6ac' class='xr-var-data-in' type='checkbox'><label for='data-91565c82-a840-42a4-83cc-cd2ef603f6ac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Austria&#x27;, &#x27;Belgium&#x27;, &#x27;Bosnia and Herzegovina&#x27;, &#x27;Bulgaria&#x27;, &#x27;Croatia&#x27;,
       &#x27;Cyprus&#x27;, &#x27;Czechia&#x27;, &#x27;Denmark&#x27;, &#x27;Estonia&#x27;, &#x27;Finland&#x27;, &#x27;France&#x27;,
       &#x27;Germany&#x27;, &#x27;Greece&#x27;, &#x27;Hungary&#x27;, &#x27;Iceland&#x27;, &#x27;Ireland&#x27;, &#x27;Italy&#x27;, &#x27;Latvia&#x27;,
       &#x27;Liechtenstein&#x27;, &#x27;Lithuania&#x27;, &#x27;Luxembourg&#x27;, &#x27;Malta&#x27;, &#x27;Netherlands&#x27;,
       &#x27;Norway&#x27;, &#x27;Poland&#x27;, &#x27;Portugal&#x27;, &#x27;Romania&#x27;, &#x27;Slovakia&#x27;, &#x27;Slovenia&#x27;,
       &#x27;Spain&#x27;, &#x27;Sweden&#x27;, &#x27;Switzerland&#x27;, &#x27;United Kingdom&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>country_code</span></div><div class='xr-var-dims'>(country_code)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AT&#x27; &#x27;BA&#x27; &#x27;BE&#x27; ... &#x27;SI&#x27; &#x27;SK&#x27; &#x27;UK&#x27;</div><input id='attrs-1e66107b-c126-4b52-9d0d-4017632993bb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e66107b-c126-4b52-9d0d-4017632993bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ba189dd-ab3e-49f3-b362-7b1421eb7c4b' class='xr-var-data-in' type='checkbox'><label for='data-1ba189dd-ab3e-49f3-b362-7b1421eb7c4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AT&#x27;, &#x27;BA&#x27;, &#x27;BE&#x27;, &#x27;BG&#x27;, &#x27;CH&#x27;, &#x27;CY&#x27;, &#x27;CZ&#x27;, &#x27;DE&#x27;, &#x27;DK&#x27;, &#x27;EE&#x27;, &#x27;EL&#x27;, &#x27;ES&#x27;,
       &#x27;FI&#x27;, &#x27;FR&#x27;, &#x27;HR&#x27;, &#x27;HU&#x27;, &#x27;IE&#x27;, &#x27;IS&#x27;, &#x27;IT&#x27;, &#x27;LI&#x27;, &#x27;LT&#x27;, &#x27;LU&#x27;, &#x27;LV&#x27;, &#x27;MT&#x27;,
       &#x27;NL&#x27;, &#x27;NO&#x27;, &#x27;PL&#x27;, &#x27;PT&#x27;, &#x27;RO&#x27;, &#x27;SE&#x27;, &#x27;SI&#x27;, &#x27;SK&#x27;, &#x27;UK&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1666a5d6-9ae7-4650-be96-b0812274aed5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1666a5d6-9ae7-4650-be96-b0812274aed5' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>HF2_PC_CHE</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 5.41 5.62 nan</div><input id='attrs-413ba8eb-c2a1-48e1-985d-0c5218af35cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-413ba8eb-c2a1-48e1-985d-0c5218af35cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fee0c50-59fc-49da-bac1-494c49dd17af' class='xr-var-data-in' type='checkbox'><label for='data-3fee0c50-59fc-49da-bac1-494c49dd17af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ nan,  nan,  nan, ..., 6.83, 6.91,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 4.86, 4.9 ,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 0.37, 0.4 ,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
...
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],

       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ..., 5.41, 5.62,  nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF2_PPS_HAB</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 160.8 172.1 nan</div><input id='attrs-6f70a240-1af6-4892-859c-5552f838eb7a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f70a240-1af6-4892-859c-5552f838eb7a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1334aef0-6ba2-4dd2-b2f4-68deb98c8d7c' class='xr-var-data-in' type='checkbox'><label for='data-1334aef0-6ba2-4dd2-b2f4-68deb98c8d7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   nan,    nan,    nan, ..., 263.61, 274.53,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 180.84, 187.76,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,   3.08,   3.48,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
...
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 160.78, 172.06,    nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF3_PC_CHE</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 15.72 15.88 nan</div><input id='attrs-2f661207-b684-426f-bb51-bd5725909e54' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2f661207-b684-426f-bb51-bd5725909e54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4c5c794-df7c-4ae4-b605-d0d0953be02b' class='xr-var-data-in' type='checkbox'><label for='data-a4c5c794-df7c-4ae4-b605-d0d0953be02b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[  nan,   nan,   nan, ..., 19.15, 18.43,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 17.91, 17.81,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 29.12, 29.31,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
...
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ..., 15.72, 15.88,   nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HF3_PPS_HAB</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 467.5 486.2 nan</div><input id='attrs-817c0729-7248-405e-ba95-71eb27fe225a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-817c0729-7248-405e-ba95-71eb27fe225a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3be79404-3656-480c-99c9-98f3989651bb' class='xr-var-data-in' type='checkbox'><label for='data-3be79404-3656-480c-99c9-98f3989651bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[   nan,    nan,    nan, ..., 739.37, 732.45,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 665.96, 682.09,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 242.47, 256.89,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
...
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan]],

       [[   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        ...,
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ...,    nan,    nan,    nan],
        [   nan,    nan,    nan, ..., 467.53, 486.25,    nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>health expenditure per capita</span></div><div class='xr-var-dims'>(country, country_code, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-458ab66c-c6e2-433a-829c-d5acf2990c83' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-458ab66c-c6e2-433a-829c-d5acf2990c83' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77d67609-b3a5-402b-9074-09a5268f5526' class='xr-var-data-in' type='checkbox'><label for='data-77d67609-b3a5-402b-9074-09a5268f5526' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[    nan,     nan, ..., 4510.08, 4689.27],
        [    nan,     nan, ...,     nan,     nan],
        ...,
        [    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan]],

       [[    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan],
        ...,
        [    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan]],

       ...,

       [[    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan],
        ...,
        [    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan]],

       [[    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ...,     nan,     nan],
        ...,
        [    nan,     nan, ...,     nan,     nan],
        [    nan,     nan, ..., 3607.59, 3838.53]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1b41f98e-7f73-40a5-9059-add68c9e2feb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1b41f98e-7f73-40a5-9059-add68c9e2feb' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df_country</span> = ds_c.to_dataframe()
df_country.reset_index(inplace=<span style="color: #f78c6c;">True</span>)
df_country.rename({<span style="color: #c3e88d;">'level_0'</span>:<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'level_1'</span>:<span style="color: #c3e88d;">'country_code'</span>,\
                   <span style="color: #c3e88d;">'level_2'</span>:<span style="color: #c3e88d;">'year'</span>},axis=1,inplace=<span style="color: #f78c6c;">True</span>)
df_country.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_code</th>
      <th>year</th>
      <th>HF2_PC_CHE</th>
      <th>HF2_PPS_HAB</th>
      <th>HF3_PC_CHE</th>
      <th>HF3_PPS_HAB</th>
      <th>health expenditure per capita</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Austria</td>
      <td>AT</td>
      <td>1992</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austria</td>
      <td>AT</td>
      <td>1993</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Austria</td>
      <td>AT</td>
      <td>1994</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Austria</td>
      <td>AT</td>
      <td>1995</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Austria</td>
      <td>AT</td>
      <td>1996</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">df</span> = df.merge(df_country, how = <span style="color: #c3e88d;">'left'</span>,\
              on = [<span style="color: #c3e88d;">'country'</span>,<span style="color: #c3e88d;">'year'</span>,<span style="color: #c3e88d;">'country_code'</span>])
<span style="color: #676E95;"># </span><span style="color: #676E95;">drop rows where deaths &gt; population at Jan. 1st</span>
<span style="color: #676E95;"># </span><span style="color: #676E95;">(e.g. because people moved in the year)</span>
df = df[(df.population &gt;= df.deaths) &amp; (df.population &gt; 0)]
df[<span style="color: #c3e88d;">'mortality'</span>] = df.deaths/df.population

df.head()
</pre>
</div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>nuts2</th>
      <th>sex</th>
      <th>year</th>
      <th>population</th>
      <th>at risk of poverty</th>
      <th>lagged_mortality</th>
      <th>percentage_material_deprivation</th>
      <th>deaths</th>
      <th>TOOEXP</th>
      <th>UNMET</th>
      <th>country_code</th>
      <th>nuts1</th>
      <th>country</th>
      <th>HF2_PC_CHE</th>
      <th>HF2_PPS_HAB</th>
      <th>HF3_PC_CHE</th>
      <th>HF3_PPS_HAB</th>
      <th>health expenditure per capita</th>
      <th>mortality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>192</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1990</td>
      <td>1345.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AT</td>
      <td>AT1</td>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>193</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1991</td>
      <td>1371.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AT</td>
      <td>AT1</td>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>194</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1992</td>
      <td>1436.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AT</td>
      <td>AT1</td>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000696</td>
    </tr>
    <tr>
      <th>195</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1993</td>
      <td>1372.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AT</td>
      <td>AT1</td>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>196</th>
      <td>1.0</td>
      <td>AT11</td>
      <td>F</td>
      <td>1994</td>
      <td>1349.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AT</td>
      <td>AT1</td>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000741</td>
    </tr>
  </tbody>
</table>
</div>

<p>
Finally, we save the merged NUTS 2 and country data into a <code>.csv</code> file.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">df.to_csv(<span style="color: #c3e88d;">'./data/data_deaths_by_age_nuts_2.csv'</span>)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jan Boone</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
